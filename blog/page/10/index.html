
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Fickle Bits</title>
  <meta name="author" content="Ben Scheirman">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="canonical" href="http://benscheirman.com/blog/page/10/index.html"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="http://s3.amazonaws.com/ender-js/jeesh.min.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/ficklebits" rel="alternate" title="Fickle Bits" type="application/atom+xml"/>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-210379-10']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  
  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>


  
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>

</head>

<body  >
  <header><hgroup>
  <h1><a href="/">Fickle Bits</a></h1>
  
    <h2>You're doing it wrong.</h2>
  
</hgroup>

</header>
  <nav role=navigation><ul role=subscription data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/ficklebits" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:benscheirman.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">



  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/02/access-denied-on-microsoft-visual-studio-web-authoring-component/">Access Denied on Microsoft Visual Studio Web Authoring Component</a></h1>
    
    
      <p class="meta">




<time datetime="2009-02-02 00:00:00 -0600" pubdate  updated >Feb 2<span>nd</span>, 2009</time>


</p>
    
  </header>


  <div class="entry-content"><p>I&#8217;m finally able to install .NET 3.5 and run Visual Studio 2008 at my client.&nbsp; Yeah, yeah,&nbsp; &#8221;<em>Welcome to 2008</em>&#8221; I can hear you say.&nbsp; &#8220;You&#8217;re just in time for VS 2010!&#8221;&nbsp; I know&#8230; but big ships turn slowly :)</p>


<p> <p>Anyway, when installing Visual Studio 2008 I was promptly greeted with a slew of errors.&nbsp; Checking the log yielded this not very helpful statement:</p> <blockquote> <p><em>[02/02/09,13:53:22] Microsoft Visual Studio Web Authoring Component: [2] Error code 5 for this component means &#8220;Access is denied.</em></p></blockquote> <p>The knowledge base article it linked to was less than helpful as well.&nbsp; A colleague asked me to crack open McAfee&#8217;s logs and sure enough&#8230; we found this in there:</p> <blockquote> <p><em>2/2/2009&nbsp;&nbsp;&nbsp; 1:41:20 PM&nbsp;&nbsp;&nbsp; Blocked by Access Protection ru&nbsp;&nbsp;&nbsp; ZZZ\user&nbsp;&nbsp;&nbsp;&nbsp; d:\wcu\webdesignercore\WebDesignerCore.EXE&nbsp;&nbsp;&nbsp; C:\7912618bc3a93fed0bab\autorun.inf&nbsp;&nbsp;&nbsp; User-defined Rules:Autorun_inf&nbsp;&nbsp;&nbsp; Action blocked : Create<br>2/2/2009&nbsp;&nbsp;&nbsp; 1:53:22 PM&nbsp;&nbsp;&nbsp; Blocked by Access Protection rule&nbsp;&nbsp;&nbsp;&nbsp; ZZZ\user d:\wcu\webdesignercore\WebDesignerCore.EXE&nbsp;&nbsp;&nbsp; C:\e300576fb9ee95c7e7e9c2cb\autorun.inf&nbsp;&nbsp;&nbsp; User-defined Rules:Autorun_inf&nbsp;&nbsp;&nbsp; Action blocked : Create<br>2/2/2009&nbsp;&nbsp;&nbsp; 2:02:08 PM&nbsp;&nbsp;&nbsp; Blocked by Access Protection rule&nbsp;&nbsp;&nbsp;&nbsp; ZZZ\user d:\wcu\webdesignercore\WebDesignerCore.EXE&nbsp;&nbsp;&nbsp; C:\9e98c3f777aff7da331d68c05065b5\autorun.inf&nbsp;&nbsp;&nbsp; User-defined Rules:Autorun_inf&nbsp;&nbsp;&nbsp; Action blocked : Create</em></p></blockquote> <p>That is three separate installation attempts that failed.&nbsp; Luckily my account had the ability to disable the sometimes-annoying-file-blocking-thingy in McAfee Enterprise.</p> <p><img src="/images/mcaffee-file-access-dialog_3_.png" alt="mcaffee-file-access-dialog"  border="0" /> </p> <p>If you&#8217;re getting this error, try disabling that guy to install Visual Studio.&nbsp; Don&#8217;t forget to turn it back on though, or the corp network security guys with shotguns might visit your desk wondering why a worm installed on your machine was sending out emails to everyone in the company with a vulgar photo&#8230;</p> <p>Hope this saves someone the 30 minutes it cost me today!</p></p>
</div>
  <footer>
    <a rel="full-article" href="/blog/2009/02/access-denied-on-microsoft-visual-studio-web-authoring-component/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/02/announcing-houston-alt-net-open-spaces-conference/">Announcing Houston ALT.NET Open Spaces Conference</a></h1>
    
    
      <p class="meta">




<time datetime="2009-02-01 00:00:00 -0600" pubdate  updated >Feb 1<span>st</span>, 2009</time>


</p>
    
  </header>


  <div class="entry-content"><p><br />
<img src="/images/zen-garden_.jpg"  style="float:left; margin-right:10px; margin-bottom:10px;"  /> I&#8217;m proud to announce that I&#8217;m organizing a Houston ALT.NET Open Spaces conference April 3rd - 5th, 2009. The open space will be facilitated by <a href="http://www.stevenlist.com/">Doc List</a>.</p>


<p>You can take a look at the <a href="http://houston.altnetconf.com/home">conference website</a>&nbsp;&nbsp;to see more details, and I&#8217;ll open registration soon. I&#8217;m not entirely sure about the cap on attendance yet, but I&#8217;m probably going to limit it to 70-80 to keep costs down.</p>


<p>The event will be held at the Microsoft offices in west Houston, and will be in the style of past ALT.NET conferences:</p>


<ul>
<li>Friday night gathering to suggest topics &amp; come up with a preliminary schedule</li>
<li>Saturday breakfast, opening statements, breakout sessions, lunch</li>
<li>Sunday morning breakfast, break out sessions, closing of the space</li>
</ul>


<p>When I start finalizing the schedule, you&#8217;ll see it on the website.</p>


<p><strong>What can you do?</strong><br /></p>


<p>Boy, I&#8217;m glad you asked! We need sponsors. If you or your company can sponsor (even a small amount) it would make things go a lot smoother. I&#8217;m trying my best to make this conference free for attendees, but I may have to charge a small fee for attendance.</p>


<p>I&#8217;ll also need people with video cameras to come help document the event. We&#8217;ll need a few folks to do this, so that we can capture each session. I&#8217;ll also need someone to bring a <em>ginormous</em> hard drive to collect all of the videos.</p>


<p><strong>What&#8217;s next?</strong></p>


<p>I have to finalize the budget, get the registration setup for the site, gather sponsors, and do general planning. If you&#8217;re interested in helping out in the planning, our next ALT.NET Geek Dinner (week of Feb 9th) will be the perfect time. (or join the mailing list).</p>


<p>I&#8217;m really excited to be putting this on. Past ALT.NET conferences have really challenged me to better my craft, and it&#8217;s time to give back &amp; spread the goodness to my local community. Leave a comment if you&#8217;re planning on attending!</p>


<br />

</div>
  <footer>
    <a rel="full-article" href="/blog/2009/02/announcing-houston-alt-net-open-spaces-conference/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/01/building-a-hackintosh/">Building a Hackintosh</a></h1>
    
    
      <p class="meta">




<time datetime="2009-01-10 00:00:00 -0600" pubdate  updated >Jan 10<span>th</span>, 2009</time>


</p>
    
  </header>


  <div class="entry-content"><p>I&#8217;m writing this post on my new hackintosh - that is - OS X Leopard running on PC hardware. So far the system is pretty stable and I&#8217;m liking it a lot.</p>


<p><img src="/images/IMG_0734_.jpg"  alt="IMG_0734.JPG"  /></p>


<p><br />
<img src="/images/leopard_.png"  alt="osx desktop"  /></p>


<p>Running OS X on PC hardware isn&#8217;t always easy, I just happened to have the lucky mix of hardware that pretty much just works. The motherboard is the most critical determining factor.</p>


<h2>My hardware</h2>


<ul>
<li><a href="http://www.zipzoomfly.com/jsp/ProductDetail.jsp?ProductCode=10008509-OP&#38;prodlist=celebros">Gigabyte EP35-DS3L</a> ($70)</li>
<li><a href="http://">Intel Core 2 Duo E8400 @ 3.0ghz</a> ($164)</li>
<li><a href="http://www.newegg.com/Product/Product.aspx?Item=N82E16814150247">NVidia 8600GT 512MB</a> ($69)</li>
<li><a href="http://www.newegg.com/Product/Product.aspx?Item=N82E16820145184">4GB Corsair Memory</a> ($55)</li>
<li>Western Digital 500GB MyBook USB Hard drive</li>
</ul>


<p>You could easily build a PC based on this hardware for under $500. We have sound, lan, any hard drive will do, a decent video card, a fast processor, and 4 GB of memory. I&#8217;m using this on my existing Vista machine, so I decided to install on an external drive. Dual booting is possible, and with USB it&#8217;s easy: just unplug the USB drive to boot in windows. Other options allow you to have a boot menu to choose the OS.</p>


<h2>Where to start</h2>


<p>The definitive place to learn how to do this is the <a href="http://forum.insanelymac.com/">Insanely Mac Forums</a>. Expect to read a TON before you start. Spend most of your time initially in the OSx86 forum.</p>


<h2>The software</h2>


<ul>
<li>I got most of my help from <a href="http://forum.insanelymac.com/index.php?showtopic=86167">this tutorial</a>. It is based on this same hardware, and pretty much worked right away for me.</li>
<li>Kalyway 10.5.2 OS X Installer<br />
You can get this from the usual places. I originally used this install and it worked okay, however I noticed a handful of application crashes and the occasional GSOD (Grey screen of death). We&#8217;re going to use this for the initial boot and to make a utility install. Utility installs will help when things go wrong, like for example if you decide to use a driver (known as kernel extensions or &#8220;kexts&#8221;) and the kext causes a kernel panic on boot, then you can boot in the utility partition and fix it.</li>
<li>Retail Leopard OS X 10.5.5<br />
You can get this at an Apple store, ebay, craigslist, or the usual places. I found one on craigslist for $50.</li>
<li>10.5.6 combo updater</li>
<li>v4.4 utility package from the tutorial author</li>
</ul>


<p>You can get the combo updater and the utility package from the tutorial post. Follow the tutorial and you should be fine.</p>


<h2>BIOS</h2>


<p>Having an updated BIOS is <em>usually</em> a good idea. In my case I had to update to F5. I also had to enable SATA AHCI, which is supposed to increase the reliability of OS X. This made Vista blue screen on boot. Apparently Vista removes unused drivers to speed up boot time. <a href="http://www.itwriting.com/blog/288-enabling-ahci-on-vista.html">Enabling a setting in the registry</a> fixed this.</p>


<h2>Create a utility install with Kalyway</h2>


<p>This is something that was confusing to me. Sort of a chicken and egg problem, but you need to install the retail install from an existing OS X installation. I used the Kalyway installer. I shrunk a partition in Windows by 40GB, then rebooted with the Kalyway DVD. It takes a while, but eventually the OS X installer came up. You then go to Disk Utility and format the partition. Choose Mac Journaled as the format. OSX should install after 10-15 minutes. This is where some folks have hardware issues. If your sound, lan, or video cards don&#8217;t work, then you have to roll up your sleeves and do some manual hacking. I lucked out and mine pretty much worked. It wasn&#8217;t very stable though.</p>


<p>Once you&#8217;re in, you can continue to boot to this install using the boot DVD. I was unable to get any bootloaders to work. This utility install will be helpful to fix any problems that arise from tinkering with the main OS.</p>


<p>From there, I followed this guide which provided me with most of what I needed to get the retail DVD installed, update to 10.5.6, run the postpatch.sh script and reboot. Then I ran the EFI hack which allows you to boot directly into OS X. At this point I set the USB drive to be first priority and viola! Leopard booted.</p>


<h2>Getting 3D Graphics working</h2>


<p>Upon booting the first time the graphics were sluggish and it could only run at 10204x768. There are a number of posts on the topic of video drivers, the problem is some of them are dated. NVinject worked for my 10.5.2 Kalyway install, but did not work for the 10.5.6 retail. Instead I had to use EFI Studio (found in the v4.4 package from earlier) and selected the 8600 GT 512 MB item.<img src="/images/efistudio_.png"  alt="efistudio.png"  /></p>


<p>Then I clicked &#8220;Add Device&#8221; which brought up this window:</p>


<p><img src="/images/efistudio2_.png"  alt="efistudio2.png"  /></p>


<p>Then click &#8220;write to com.apple.Boot.plist&#8221;, reboot and you&#8217;re good! To get sound working I had to install the <a href="http://forum.insanelymac.com/index.php?act=attach&#38;type=post&#38;id=20698">ALC888 kext</a>.</p>


<h2>Installing kexts</h2>


<p>Installing kexts is basically copying a file to /System/Library/Extensions, fixing up the permissions on the file(s) with</p>




<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>sudo chmod -R 755 /System/Library/Extensions/yourkext.kext&lt;br />sudo chown -R root:wheel /System/Library/Extensions/yourkext.kext</div></code></pre></td></tr></table></div></figure></div>




<p>then you need to remove the kext caches like so:</p>




<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>sudo rm -R /System/Library/Extensions.kextcache&lt;br />sudo rm -R /System/Library/Extensions.mkext</div></code></pre></td></tr></table></div></figure></div>




<p>Reboot and cross your fingers! If you get a kernel panic, then just boot in single user mode (press F8 at boot and type -s at the prompt) (or boot your utility install) and remove the offending kexts.</p>


<p>I found it easy to automate this process using <a href="http://cheetha.net/">KextHelper</a>.</p>


<p>At this point I have a fully retail copy of 10.5.6, and I&#8217;m a &#8220;Mac Pro&#8221; in the eyes of Apple. This means (I think) that I can update to future versions with little to no tweaking!</p>


<p><br />
<img src="/images/about-this-mac_.png"  alt="about-this-mac.png"  /></p>


<p><br />
<img src="/images/about-this-mac2_.png"  alt="about-this-mac2.png"  /></p>


<p>If I were to build a Mac Pro from apple.com with these specs, <strong>it would cost near $3000!</strong></p>


<h2>Things still to figure out</h2>


<p>My Microsoft Lifecam v1000 doesn&#8217;t quite work. I got it to work in iChat for a few minutes, but doesn&#8217;t work in Photobooth or Skype. This is a minor setback, as I can just buy a supported one.</p>


<p>My RAID array isn&#8217;t visible. I have 2x250gb drives in RAID 1 (stripe). I need to investigate &#38; see if there are drivers for my SATA raid card. All in all it&#8217;s a small loss.</p>


<p>VNC comes built-in with 10.5.6, however it&#8217;s SO SLOOOOWWW over the internet. Remote Desktop is far superior because they aren&#8217;t streaming bitmaps, it is actually rendering a desktop locally &#38; transmitting state changes. I really want to find a better solution for accessing my PC remotely.</p>


<h2>Conclusion</h2>


<p>This system has been really stable so far. I&#8217;ve had one crash, and I&#8217;m not sure what caused it, but a week has gone by with no lockups or crashes whatsoever. I&#8217;m really close to ditching my Vista install and put this on my fast Western Digital Raptor main drive.</p>


<p>&nbsp;&#160;</p>

</div>
  <footer>
    <a rel="full-article" href="/blog/2009/01/building-a-hackintosh/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/01/last-night-at-hdnug/">Last Night at HDNUG</a></h1>
    
    
      <p class="meta">




<time datetime="2009-01-09 00:00:00 -0600" pubdate  updated >Jan 9<span>th</span>, 2009</time>


</p>
    
  </header>


  <div class="entry-content"><p>Thanks to HDNUG for inviting me to speak again.&nbsp; I always enjoy it.&nbsp; The crowd was a little thin this time around, but I think that&#8217;s because the website wasn&#8217;t updated with the meeting information in time.</p>


<p> <p>I spoke about latest updates to the ASP.NET MVC Framework, and did some off-the-cuff coding to demonstrate the features.&nbsp; I didn&#8217;t get a chance to touch on a few subjects, but all in all I think it was well received.</p> <p>I made the point early on that ASP.NET MVC is an option, and that not everyone would get it.&nbsp; That&#8217;s fine!&nbsp; It&#8217;s meant for a specific type of developer who cares deeply about certain things, namely control over HTML, URLS, tight integration with HTTP and Javascript, and ajax.&nbsp; And who can possibly leave out better separation of concerns &amp; testability.</p> <p><img src="/images/mvc-an-option_3_.png" alt="mvc-an-option"  border="0" /> </p> <p>There were certainly folks in the camp that didn&#8217;t get it in the audience.&nbsp; I hope that I adequately represented what MVC is and how it works well on ASP.NET.</p> <p>You can <a href="http://benscheirman.googlecode.com/svn/trunk/presentations/hdnug%20%2001-2009/hdnug%2009.pptx" target="_blank">download the slides for the talk</a>, however I am unable to post the code because it references a private release that I cannot distribute.&nbsp; As soon as the RC becomes available, I&#8217;ll post the code online.</p></p>
</div>
  <footer>
    <a rel="full-article" href="/blog/2009/01/last-night-at-hdnug/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/12/obligatory-2008-recap/">Obligatory 2008 Recap</a></h1>
    
    
      <p class="meta">




<time datetime="2008-12-31 00:00:00 -0600" pubdate  updated >Dec 31<span>st</span>, 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p>What kind of blogger would I be if I didn&#8217;t do a recap of the year?&nbsp; <em>Well I guess since I&#8217;ve never done this before, not a very good one.</em>&nbsp; 2008 was a phenomenal year.</p>


<p> <h2></h2> <h2>Me</h2> <p>I started out the year doing my <a href="http://flux88.com/blog/asp-net-mvc-tour-of-texas/">ASP.NET MVC Tour of Texas</a>, where I visited San Antonio, Austin, Fort Worth, and Houston talking about ASP.NET MVC.&nbsp; It must have gotten some notice, because shortly after I was invited to be a co-author for <a href="http://manning.com/palermo" target="_blank">ASP.NET MVC in Action</a>.&nbsp; The book is getting close to being completed, so expect to see it on store shelves in the coming months.</p> <p>In April, I attended the 2nd ALT.NET gathering, which inspirational and eye-opening (<a href="http://flux88.com/blog/alt-net-day-1/">Day1</a>, <a href="http://flux88.com/blog/alt-net-day-2/">Day2</a>, <a href="http://flux88.com/blog/alt-net-day-2-continued/">Day2.2</a>, <a href="http://flux88.com/blog/alt-net-day-3/">Day3</a>).</p> <p>In May <a href="http://flux88.com/blog/i-m-an-insider/">I became an ASP Insider</a>.&nbsp; This has been the very best way to give my feedback to Microsoft about upcoming releases.&nbsp; Also in May I started holding semi-regular <a href="http://flux88.com/blog/houston-alt-net-geek-dinner-next-tuesday/">Houston ALT.NET Geek Dinners</a>.</p> <p>In September, the nasty hurricane Ike rolled through Houston, luckily <a href="http://flux88.com/blog/ike-is-gone-we-re-okay/">we made it through with little damage</a>.&nbsp; Others were not as fortunate.</p> <p>In October <a href="http://flux88.com/blog/recent-developments/">I was given the Microsoft MVP Award for ASP.NET</a>.&nbsp; I&#8217;m looking forward to going to the summit next March &amp; meeting other MVPs from around the world.</p> <p>I attended <a href="http://kaizenconf.com/" target="_blank">KaizenConf</a> in November, which was really great.&nbsp; Every time I go to one of these conferences I feel energized to go out and do good in the world.&nbsp; It sounds cheesy, but it&#8217;s really great.&nbsp; I hope that others find their way out of the mainstream marketing jungle of conferences and attend one of these open spaces.</p> <p>In December, my wife and I found out that <a href="http://flux88.com/blog/hello-world-x-2/">we are having twins</a>!&nbsp; For those counting, we&#8217;ll now have a full basketball team :).&nbsp; Needless to say 2009 will be a busy year.</p> <h2>The blog</h2> <p>This blog has gone under some transition too.&nbsp; Originally I was using <a href="http://dasblog.info" target="_blank">dasBlog</a> hosted at <a href="http://webhost4life.com" target="_blank">WebHost4Life</a> and things worked pretty well.&nbsp; I wanted to have some more control over what I could do with my server, so I ordered a VPS plan with VPS Land.&nbsp; That turned out to be a big mistake.&nbsp; </p> <p>I quickly moved over to a VPS over at <a href="http://godaddy.com" target="_blank">GoDaddy</a> which worked out okay for most of the year.&nbsp; It turns out their domain service is better than their hosting service.&nbsp; My blog kept making it run out of memory, so I moved my blog over to <a href="http://www.orcsweb.com" target="_blank">Orcsweb</a>.&nbsp; I also ported the content over to Graffiti, and so far it has been smooth sailing ever since.&nbsp; I still host my <a href="http://silvia.flux88.com" target="_blank">wife&#8217;s</a> and <a href="http://heather.flux88.com" target="_blank">sister&#8217;s</a> blogs on GoDaddy, as well as my <a href="http://www.cripplecreekwoodworks.com" target="_blank">uncle&#8217;s furniture business</a>.</p> <h2>What&#8217;s in store for 2009?</h2> <p>I have a few goals for 2009 that I&#8217;d like to publicly share, if for no other reason than to really commit to it.&nbsp; I&#8217;d like to wrap up the book.&nbsp; It is time consuming like you wouldn&#8217;t believe, and I&#8217;ll be glad when it&#8217;s over.&nbsp; </p> <p>I&#8217;d also like to read more.&nbsp; It seems that I only read 6 or 7 books in 2008, and that&#8217;s pathetic.&nbsp; At the rate that my book list is growing, I&#8217;ll never read all that I want.&nbsp; So far 99% of the books on my list are about software development, and I&#8217;d like to change that.&nbsp; I&#8217;m starting to get interested in other things, like GTD, organization, fiction&#8230;&nbsp; I need to broaden my horizons.</p> <p>I&#8217;d like to do another long series of posts, similar to my <a href="http://flux88.com/blog/a-journey-with-nhibernate-part-1/" target="_blank">Journey with NHibernate</a> series.&nbsp; It still remains my all time most popular set of posts, and now the material is a little dated.&nbsp; I&#8217;ve learned a lot since then.&nbsp; I&#8217;m definitely open to ideas.</p> <p>I&#8217;m also going to get back into guitar.&nbsp; In 2008 I really didn&#8217;t play more than once a month, and it shows.&nbsp; My fingers are soft, I&#8217;ve forgotten how to play many songs, and I&#8217;ve definitely lost my technique for fingering.&nbsp; It&#8217;s all chords now.&nbsp; I&#8217;m looking at purchasing a new electric guitar to help give me the nudge.</p> <p>Lastly, I would like to do another speaking tour, only this time I&#8217;m not sure what topic.&nbsp; It was a ton of fun, and maybe this time I can get a sponsor to help me visit more cities.</p> <p>So long 2008, you were great.</p></p>
</div>
  <footer>
    <a rel="full-article" href="/blog/2008/12/obligatory-2008-recap/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/12/houston-alt-net-geek-dinner-january-7th/">Houston ALT.NET Geek Dinner - January 7th</a></h1>
    
    
      <p class="meta">




<time datetime="2008-12-30 00:00:00 -0600" pubdate  updated >Dec 30<span>th</span>, 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p><a href="http://flux88.com/files/media/image/WindowsLiveWriter/HoustonALT.NETGeekDinnerJanuary7th_805B/63782302_e7b67dd102_m_2.jpg"><img src="/images/63782302_e7b67dd102_m_thumb_.jpg" alt="63782302_e7b67dd102_m"  border="0" /></a> </p>


<p> <p>Now that the holidays are coming to a close, it&#8217;s time to get back in the grind.&nbsp; That means community, baby!&nbsp; </p> <p>We&#8217;re going to hold our semi-monthly casual Houston ALT.NET Geek Dinner at Freebird&#8217;s World Burrito near 59 &amp; Shepherd.&nbsp; If you haven&#8217;t eaten a Freebird&#8217;s burrito then you&#8217;re in for a treat.&nbsp; They&#8217;re huge and delicious.&nbsp; <em>(Veggie burritos are certainly available for you herbivores out there).</em></p> <table cellspacing="0" cellpadding="2" width="447" border="0"> <tbody> <tr> <td valign="top" width="116"><strong>When?</strong></td> <td valign="top" width="329">Wednesday Jan 07th, 2008 @ 6:00pm<br><a href="https://www.google.com/calendar/event?action=TEMPLATE&amp;tmeid=b3FnYmw1NTkyb2RjYjEzcmtqbzlxdDEwNG8gc3ViZGlnaXRhbEBt&amp;tmsrc=c3ViZGlnaXRhbEBnbWFpbC5jb20" target="_blank"><img src="/images/gc_button1_en__.gif"  border="0" /></a> </td></tr> <tr> <td valign="top" width="116"><strong>Where?</strong></td> <td valign="top" width="329"><a href="http://freebirds.com/" target="_blank">Freebirds</a> (<a href="http://maps.google.com/maps?f=q&amp;hl=en&amp;geocode=&amp;q=3745+Greenbriar,+Houston&amp;sll=37.0625,-95.677068&amp;sspn=55.148262,79.101563&amp;ie=UTF8&amp;ll=29.732772,-95.41244&amp;spn=0.007472,0.009656&amp;z=17&amp;g=3745+Greenbriar,+Houston&amp;iwloc=addr" target="_blank">map</a>)</td></tr></tbody></table> <p><em></em>&nbsp;<br>Hopefully <em>somebody</em> will join me for a beer this time!</p> <p>Some topics that have been suggested:</p> <ul> <li>Oxite Aftermath</li> <li>ASP.NET MVC</li> <li>DDD Discussion</li> <li>RIA Frameworks</li> <li>DI / IoC Frameworks</li> <li>Survey:&nbsp; What are you doing to be/promote agile where you work?</li> <li>Mentoring</li> <li>The agile wall &amp; pull systems</li> <li>Cloud Computing</li> <li>DSLs</li></ul> <p>We&#8217;ll have to trim that list otherwise we&#8217;ll be there all night.&nbsp; Tell your friends, blog about it, whatever you have to do, but <em>get your co-workers out here!</em>&nbsp; Making connections in the community is a great way to becoming a better developer.</p></p>
</div>
  <footer>
    <a rel="full-article" href="/blog/2008/12/houston-alt-net-geek-dinner-january-7th/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/12/hello-world-x-2/">Hello World X 2</a></h1>
    
    
      <p class="meta">




<time datetime="2008-12-10 00:00:00 -0600" pubdate  updated >Dec 10<span>th</span>, 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p>&#160;<img src="/images/image0_6_.jpg" alt="sonogram"  border="0"  /></p>

</div>
  <footer>
    <a rel="full-article" href="/blog/2008/12/hello-world-x-2/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/12/speaking-at-the-microsoft-developer-conference/">Speaking at the Microsoft Developer Conference</a></h1>
    
    
      <p class="meta">




<time datetime="2008-12-02 00:00:00 -0600" pubdate  updated >Dec 2<span>nd</span>, 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p><a href="http://www.msdndevcon.com"><img src="/images/clip_image001_3_.gif" border="0"  title="clip_image001"  /></a></p>


<h5>I&#8217;ll be speaking at the upcoming <a href="http://www.msdndevcon.com">MSDN Developer Conference</a> in Houston (on December 9th) and in Dallas (January 26th).&nbsp; The topics will be similar to what was covered at the PDC this year, so if you weren&#8217;t able to attend, be sure to check this out.</h5>


<p>It&#8217;s just $99 and there&#8217;ll be some cool prizes for attendees.</p>


<p><a href="http://www.msdndevcon.com/Pages/sessions.aspx">Check out the session line up</a>&hellip;</p>


<table width="743" cellspacing="2" cellpadding="2" align="left" unselectable="on">
<tbody>
<tr>
<th width="237" class="tableGreen">Cloud Services</th>
<th width="274" class="tableBlue">Client and Presentation</th>
<th width="282" class="tableOrange">Tools, Languages and Framework</th>
</tr>
<tr>
<td width="237">Lap Around Cloud Services</td>
<td width="274">Windows Presentation Framework (WPF) Roadmap</td>
<td width="282">The Future of Managed Languages: F#, C#, and Visual Basic</td>
</tr>
<tr>
<td width="237"><font color="#ff8000">Developing and Deploying Your First Cloud Services*</font></td>
<td width="274">Developing Data-centric Applications Using the WPF DataGrid and Ribbon Controls</td>
<td width="282">A Lap Around &quot;Oslo&quot;</td>
</tr>
<tr>
<td width="237">A Lap Around the Live Framework and Mesh Services</td>
<td width="274">Building Business Focused Applications using Silverlight 2</td>
<td width="282">&quot;Rosario&quot;: A Sprint with the Next Version of Microsoft Visual Studio Team System</td>
</tr>
<tr>
<td width="237">Developing Applications Using Data Services</td>
<td width="274"><font color="#ff8000">ASP.NET 4.0 Roadmap*</font></td>
<td width="282">Parallel Programming for Managed Code Developers</td>
</tr>
</tbody>
</table>


<p>&nbsp;</p>


<p><font color="#ff8000">* my sessions</font></p>


<p>
<table width="611" cellspacing="0" cellpadding="0" border="0" style="width: 100%;" class="locations">
<tbody>
<tr>
<th width="107">Date</th>
<th width="502">
<p align="left">City</p>
</th>
</tr>
<tr>
<td width="107">12/9/08</td>
<td width="502"><a href="http://www.msdndevcon.com/Pages/Houston.aspx">Houston, TX</a>&nbsp;</td>
</tr>
<tr>
<td width="107">1/26/09</td>
<td width="502"><a href="http://www.msdndevcon.com/Pages/Dallas.aspx">Dallas, TX</a>&nbsp;</td>
</tr>
</tbody>
</table>
</p>


<p>If you aren&#8217;t close to Houston or Dallas, the MDC is coming to a handful of other cities, so check the <a target="_blank" href="http://www.msdndevcon.com">conference website</a> for more details.</p>


<p>Hope to see you there!</p>

</div>
  <footer>
    <a rel="full-article" href="/blog/2008/12/speaking-at-the-microsoft-developer-conference/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/11/fluent-route-testing-in-asp-net-mvc/">Fluent Route Testing in ASP.NET MVC</a></h1>
    
    
      <p class="meta">




<time datetime="2008-11-25 00:00:00 -0600" pubdate  updated >Nov 25<span>th</span>, 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p>Have you written code like this recently?</p>


<p>&nbsp;</p>


<!--
{\rtf1\ansi\ansicpg\lang1024\noproof1252\uc1 \deff0{\fonttbl{\f0\fnil\fcharset0\fprq1 Consolas;}}{\colortbl;??\red238\green238\blue238;\red32\green32\blue32;\red255\green0\blue128;\red144\green238\blue144;\red242\green240\blue223;\red192\green192\blue192;\red0\green255\blue255;}??\fs26 \cf1\cb2\highlight2 [\cf3 Test\cf1 ]\par ??\cf4 public\cf1  \cf4 void\cf1  \cf5 tedious_route_test\cf1 ()\par ??\{\par ??    \cf3 Global\cf6 .\cf5 RegisterRoutes\cf1 (\cf3 RouteTable\cf6 .\cf5 Routes\cf1 );\par ??    \cf4 var\cf1  \cf5 httpContext\cf1  \cf6 =\cf1  \cf3 MockRepository\cf6 .\cf5 GenerateStub\cf6 &lt;\cf3 HttpContextBase\cf6 &gt;\cf1 ();\par ??    \cf5 httpContext\cf6 .\cf5 Stub\cf1 (\cf5 x\cf1  \cf6 =&gt;\cf1  \cf5 x\cf6 .\cf5 Request\cf1 )\cf6 .\cf5 Return\cf1 (\cf3 MockRepository\cf6 .\cf5 GenerateStub\cf6 &lt;\cf3 HttpRequestBase\cf6 &gt;\cf1 ());\par ??    \cf5 httpContext\cf6 .\cf5 Request\cf6 .\cf5 Stub\cf1 (\cf5 x\cf1  \cf6 =&gt;\cf1  \cf5 x\cf6 .\cf5 PathInfo\cf1 )\cf6 .\cf5 Return\cf1 (\cf7 {\b ""}\cf1 );\par ??    \cf5 httpContext\cf6 .\cf5 Request\cf6 .\cf5 Stub\cf1 (\cf5 x\cf1  \cf6 =&gt;\cf1  \cf5 x\cf6 .\cf5 AppRelativeCurrentExecutionFilePath\cf1 )\cf6 .\cf5 Return\cf1 (\cf7 {\b "~/foo/bar"}\cf1 );\par ??\par ??    \cf4 var\cf1  \cf5 routeData\cf1  \cf6 =\cf1  \cf3 RouteTable\cf6 .\cf5 Routes\cf6 .\cf5 GetRouteData\cf1 (\cf5 httpContext\cf1 );\par ??\par ??    \cf3 Assert\cf6 .\cf5 That\cf1 (\cf5 routeData\cf6 .\cf5 Values\cf1 [\cf7 {\b "controller"}\cf1 ], \cf3 Is\cf6 .\cf5 EqualTo\cf1 (\cf7 {\b "foo"}\cf1 ));\par ??    \cf3 Assert\cf6 .\cf5 That\cf1 (\cf5 routeData\cf6 .\cf5 Values\cf1 [\cf7 {\b "action"}\cf1 ], \cf3 Is\cf6 .\cf5 EqualTo\cf1 (\cf7 {\b "bar"}\cf1 ));\par ??\}\par ??}
-->


<div style="padding: 10px; background: rgb(32, 32, 32) none repeat scroll 0% 0%; font-size: 13pt; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; color: rgb(238, 238, 238); font-family: consolas,courier new;">
<p style="margin: 0px;">[<span style="color: rgb(255, 0, 128);">Test</span>]</p>
<p style="margin: 0px;"><span style="color: rgb(144, 238, 144);">public</span> <span style="color: rgb(144, 238, 144);">void</span> <span style="color: rgb(242, 240, 223);">tedious_route_test</span>()</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 0, 128);">Global</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">RegisterRoutes</span>(<span style="color: rgb(255, 0, 128);">RouteTable</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Routes</span>);</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: rgb(144, 238, 144);">var</span> <span style="color: rgb(242, 240, 223);">httpContext</span> <span style="color: silver;">=</span> <span style="color: rgb(255, 0, 128);">MockRepository</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">GenerateStub</span><span style="color: silver;">&lt;</span><span style="color: rgb(255, 0, 128);">HttpContextBase</span><span style="color: silver;">&gt;</span>();</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: rgb(242, 240, 223);">httpContext</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Stub</span>(<span style="color: rgb(242, 240, 223);">x</span> <span style="color: silver;">=&gt;</span> <span style="color: rgb(242, 240, 223);">x</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Request</span>)<span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Return</span>(<span style="color: rgb(255, 0, 128);">MockRepository</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">GenerateStub</span><span style="color: silver;">&lt;</span><span style="color: rgb(255, 0, 128);">HttpRequestBase</span><span style="color: silver;">&gt;</span>());</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: rgb(242, 240, 223);">httpContext</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Request</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Stub</span>(<span style="color: rgb(242, 240, 223);">x</span> <span style="color: silver;">=&gt;</span> <span style="color: rgb(242, 240, 223);">x</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">PathInfo</span>)<span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Return</span>(<span style="font-weight: bold; color: aqua;">&quot;&quot;</span>);</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: rgb(242, 240, 223);">httpContext</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Request</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Stub</span>(<span style="color: rgb(242, 240, 223);">x</span> <span style="color: silver;">=&gt;</span> <span style="color: rgb(242, 240, 223);">x</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">AppRelativeCurrentExecutionFilePath</span>)<span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Return</span>(<span style="font-weight: bold; color: aqua;">&quot;~/foo/bar&quot;</span>);</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: rgb(144, 238, 144);">var</span> <span style="color: rgb(242, 240, 223);">routeData</span> <span style="color: silver;">=</span> <span style="color: rgb(255, 0, 128);">RouteTable</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Routes</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">GetRouteData</span>(<span style="color: rgb(242, 240, 223);">httpContext</span>);</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 0, 128);">Assert</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">That</span>(<span style="color: rgb(242, 240, 223);">routeData</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Values</span>[<span style="font-weight: bold; color: aqua;">&quot;controller&quot;</span>], <span style="color: rgb(255, 0, 128);">Is</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">EqualTo</span>(<span style="font-weight: bold; color: aqua;">&quot;foo&quot;</span>));</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 0, 128);">Assert</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">That</span>(<span style="color: rgb(242, 240, 223);">routeData</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Values</span>[<span style="font-weight: bold; color: aqua;">&quot;action&quot;</span>], <span style="color: rgb(255, 0, 128);">Is</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">EqualTo</span>(<span style="font-weight: bold; color: aqua;">&quot;bar&quot;</span>));</p>
<p style="margin: 0px;">}</p>
</div>


<p>This mess of nastiness is what is required to test your routes in ASP.NET MVC.&nbsp; There are a number of things wrong with this.&nbsp; First and foremost, we&#8217;re doing magical-mocking here.&nbsp; That is - we somehow know exactly the two properties we need to mock for this to work.&nbsp; It turns out this isn&#8217;t such a magical process as it is looking at reflector and a lot of trial and error.&nbsp; The next thing wrong that I see is that our route values (and keys) are case-insensitive, so we&#8217;d need to include some more flexibility in our Asserts here.</p>


<p>Who wants to deal with that mess?&nbsp; I sure don&#8217;t.&nbsp; Last night, my pal &amp; co-author <a href="http://www.lostechies.com/blogs/jimmy_bogard" target="_blank">Jimmy Bogard</a> banged together a fluent API for testing routes without needing all of this crap.</p>


<p>Here is a test to verify our root route is working properly:</p>


<!--
{\rtf1\ansi\ansicpg\lang1024\noproof1252\uc1 \deff0{\fonttbl{\f0\fnil\fcharset0\fprq1 Consolas;}}{\colortbl;??\red0\green255\blue255;\red32\green32\blue32;\red192\green192\blue192;\red242\green240\blue223;\red238\green238\blue238;\red255\green0\blue128;}??\fs26 \cf1\cb2\highlight2 {\b "~/"}\cf3 .\cf4 Route\cf5 ()\cf3 .\cf4 ShouldMapTo\cf3 &lt;\cf6 FooController\cf3 &gt;\cf5 (); }
-->


<div style="padding: 10px; background: rgb(32, 32, 32) none repeat scroll 0% 0%; font-size: 13pt; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; color: rgb(238, 238, 238); font-family: consolas,courier new;">
<p style="margin: 0px;"><span style="font-weight: bold; color: aqua;">&quot;~/&quot;</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Route</span>()<span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">ShouldMapTo</span><span style="color: silver;">&lt;</span><span style="color: rgb(255, 0, 128);">FooController</span><span style="color: silver;">&gt;</span>();</p>
</div>


<p>And a more complex case where we have an action parameter:</p>


<!--
{\rtf1\ansi\ansicpg\lang1024\noproof1252\uc1 \deff0{\fonttbl{\f0\fnil\fcharset0\fprq1 Consolas;}}{\colortbl;??\red0\green255\blue255;\red32\green32\blue32;\red192\green192\blue192;\red242\green240\blue223;\red238\green238\blue238;\red255\green0\blue128;}??\fs26 \cf1\cb2\highlight2 {\b "~/foo/bar/widget"}\cf3 .\cf4 Route\cf5 ()\cf3 .\cf4 ShouldMapTo\cf3 &lt;\cf6 FooController\cf3 &gt;\cf5 (\cf4 x\cf5  \cf3 =&gt;\cf5  \cf4 x\cf3 .\cf4 Bar\cf5 (\cf1 {\b "widget"}\cf5 ));}
-->


<div style="padding: 10px; background: rgb(32, 32, 32) none repeat scroll 0% 0%; font-size: 13pt; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; color: rgb(238, 238, 238); font-family: consolas,courier new;">
<p style="margin: 0px;"><span style="font-weight: bold; color: aqua;">&quot;~/foo/bar/widget&quot;</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Route</span>()<span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">ShouldMapTo</span><span style="color: silver;">&lt;</span><span style="color: rgb(255, 0, 128);">FooController</span><span style="color: silver;">&gt;</span>(<span style="color: rgb(242, 240, 223);">x</span> <span style="color: silver;">=&gt;</span> <span style="color: rgb(242, 240, 223);">x</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Bar</span>(<span style="font-weight: bold; color: aqua;">&quot;widget&quot;</span>));</p>
</div>


<p>These are a lot nicer, as we are dealing with no unnecessary string here, the controller are now strongly-typed (we get intellisense and refactoring support), and we can easily test routes with a single line.</p>


<p>This does have a couple caveats though:&nbsp; it assumes</p>


<ul>
<li>you&#8217;re using NUnit</li>
<li>you&#8217;re using RhinoMocks</li>
<li>you add your routes to the RouteTable.Routes collection</li>
</ul>


<p>So how did we do this?&nbsp; I have to admit, I tried to get this to work on the bus ride to work, but without an internet connection I was dead in the water.&nbsp; Jimmy helped me grasp the way that Expression&lt;T&gt; works.&nbsp; His wise words were: &quot;Here&#8217;s where you just set a breakpoint and fire up the debugger and look.&quot;&nbsp; He&#8217;s right - the API there is quite opaque.&nbsp; But once I got it to&nbsp; work it made a lot of sense.&nbsp; Expression&lt;T&gt; is awesome!</p>


<p>Here&#8217;s the method with most of the goods:</p>


<!--
{\rtf1\ansi\ansicpg\lang1024\noproof65001\uc1 \deff0{\fonttbl{\f0\fnil\fcharset0\fprq1 Consolas;}}{\colortbl;??\red144\green238\blue144;\red32\green32\blue32;\red238\green238\blue238;\red255\green0\blue128;\red242\green240\blue223;\red192\green192\blue192;\red255\green255\blue0;\red0\green255\blue255;\red164\green164\blue164;}??\fs26 \cf1\cb2\highlight2 public\cf3  \cf1 static\cf3  \cf4 RouteData\cf3  \cf5 ShouldMapTo\cf6 &lt;\cf5 TController\cf6 &gt;\cf3 (\cf1 this\cf3  \cf4 RouteData\cf3  \cf5 routeData\cf3 , \cf4 Expression\cf6 &lt;\cf7 Func\cf6 &lt;\cf5 TController\cf3 , \cf4 ActionResult\cf6 &gt;&gt;\cf3  \cf5 action\cf3 )\par ??    \cf1 where\cf3  \cf5 TController\cf3  : \cf4 Controller\par ??\cf3 \{            \par ??    \cf4 Assert\cf6 .\cf5 That\cf3 (\cf5 routeData\cf3 , \cf4 Is\cf6 .\cf5 Not\cf6 .\cf5 Null\cf3 , \cf8 {\b "The URL did not match any route"}\cf3 );\par ??\par ??    \cf9 {\b //check controller}\par ??\cf3     \cf5 routeData\cf6 .\cf5 ShouldMapTo\cf6 &lt;\cf5 TController\cf6 &gt;\cf3 ();\par ??    \par ??    \cf9 {\b //check action}\par ??\cf3     \cf1 var\cf3  \cf5 methodCall\cf3  \cf6 =\cf3  (\cf4 MethodCallExpression\cf3 ) \cf5 action\cf6 .\cf5 Body\cf3 ;\par ??    \cf1 string\cf3  \cf5 actualAction\cf3  \cf6 =\cf3  \cf5 routeData\cf6 .\cf5 Values\cf6 .\cf5 GetValue\cf3 (\cf8 {\b "action"}\cf3 )\cf6 .\cf5 ToString\cf3 ();\par ??    \cf1 string\cf3  \cf5 expectedAction\cf3  \cf6 =\cf3  \cf5 methodCall\cf6 .\cf5 Method\cf6 .\cf5 Name\cf3 ;\par ??    \cf5 actualAction\cf6 .\cf5 AssertSameStringAs\cf3 (\cf5 expectedAction\cf3 );\par ??                \par ??    \cf9 {\b //check parameters}\par ??\cf3     \cf1 for\cf3  (\cf1 int\cf3  \cf5 i\cf3  \cf6 =\cf3  \cf8 0\cf3 ; \cf5 i\cf3  \cf6 &lt;\cf3  \cf5 methodCall\cf6 .\cf5 Arguments\cf6 .\cf5 Count\cf3 ; \cf5 i\cf6 ++\cf3 )\par ??    \{\par ??        \cf1 string\cf3  \cf5 name\cf3  \cf6 =\cf3  \cf5 methodCall\cf6 .\cf5 Method\cf6 .\cf5 GetParameters\cf3 ()[\cf5 i\cf3 ]\cf6 .\cf5 Name\cf3 ;\par ??        \cf1 object\cf3  \cf5 value\cf3  \cf6 =\cf3  ((\cf4 ConstantExpression\cf3 ) \cf5 methodCall\cf6 .\cf5 Arguments\cf3 [\cf5 i\cf3 ])\cf6 .\cf5 Value\cf3 ;\par ??\par ??        \cf4 Assert\cf6 .\cf5 That\cf3 (\cf5 routeData\cf6 .\cf5 Values\cf6 .\cf5 GetValue\cf3 (\cf5 name\cf3 ), \cf4 Is\cf6 .\cf5 EqualTo\cf3 (\cf5 value\cf6 .\cf5 ToString\cf3 ()));\par ??    \}\par ??\par ??    \cf1 return\cf3  \cf5 routeData\cf3 ;\par ??\}\par ??}
-->


<div style="padding: 10px; background: rgb(32, 32, 32) none repeat scroll 0% 0%; font-size: 13pt; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; color: rgb(238, 238, 238); font-family: consolas,courier new;">
<p style="margin: 0px;"><span style="color: rgb(144, 238, 144);">public</span> <span style="color: rgb(144, 238, 144);">static</span> <span style="color: rgb(255, 0, 128);">RouteData</span> <span style="color: rgb(242, 240, 223);">ShouldMapTo</span><span style="color: silver;">&lt;</span><span style="color: rgb(242, 240, 223);">TController</span><span style="color: silver;">&gt;</span>(<span style="color: rgb(144, 238, 144);">this</span> <span style="color: rgb(255, 0, 128);">RouteData</span> <span style="color: rgb(242, 240, 223);">routeData</span>, <span style="color: rgb(255, 0, 128);">Expression</span><span style="color: silver;">&lt;</span><span style="color: yellow;">Func</span><span style="color: silver;">&lt;</span><span style="color: rgb(242, 240, 223);">TController</span>, <span style="color: rgb(255, 0, 128);">ActionResult</span><span style="color: silver;">&gt;&gt;</span> <span style="color: rgb(242, 240, 223);">action</span>)</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: rgb(144, 238, 144);">where</span> <span style="color: rgb(242, 240, 223);">TController</span> : <span style="color: rgb(255, 0, 128);">Controller</span></p>
<p style="margin: 0px;">{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 0, 128);">Assert</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">That</span>(<span style="color: rgb(242, 240, 223);">routeData</span>, <span style="color: rgb(255, 0, 128);">Is</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Not</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Null</span>, <span style="font-weight: bold; color: aqua;">&quot;The URL did not match any route&quot;</span>);</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="font-weight: bold; color: rgb(164, 164, 164);">//check controller</span></p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: rgb(242, 240, 223);">routeData</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">ShouldMapTo</span><span style="color: silver;">&lt;</span><span style="color: rgb(242, 240, 223);">TController</span><span style="color: silver;">&gt;</span>();</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="font-weight: bold; color: rgb(164, 164, 164);">//check action</span></p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: rgb(144, 238, 144);">var</span> <span style="color: rgb(242, 240, 223);">methodCall</span> <span style="color: silver;">=</span> (<span style="color: rgb(255, 0, 128);">MethodCallExpression</span>) <span style="color: rgb(242, 240, 223);">action</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Body</span>;</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: rgb(144, 238, 144);">string</span> <span style="color: rgb(242, 240, 223);">actualAction</span> <span style="color: silver;">=</span> <span style="color: rgb(242, 240, 223);">routeData</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Values</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">GetValue</span>(<span style="font-weight: bold; color: aqua;">&quot;action&quot;</span>)<span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">ToString</span>();</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: rgb(144, 238, 144);">string</span> <span style="color: rgb(242, 240, 223);">expectedAction</span> <span style="color: silver;">=</span> <span style="color: rgb(242, 240, 223);">methodCall</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Method</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Name</span>;</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: rgb(242, 240, 223);">actualAction</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">AssertSameStringAs</span>(<span style="color: rgb(242, 240, 223);">expectedAction</span>);</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="font-weight: bold; color: rgb(164, 164, 164);">//check parameters</span></p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: rgb(144, 238, 144);">for</span> (<span style="color: rgb(144, 238, 144);">int</span> <span style="color: rgb(242, 240, 223);">i</span> <span style="color: silver;">=</span> <span style="color: aqua;">0</span>; <span style="color: rgb(242, 240, 223);">i</span> <span style="color: silver;">&lt;</span> <span style="color: rgb(242, 240, 223);">methodCall</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Arguments</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Count</span>; <span style="color: rgb(242, 240, 223);">i</span><span style="color: silver;">++</span>)</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(144, 238, 144);">string</span> <span style="color: rgb(242, 240, 223);">name</span> <span style="color: silver;">=</span> <span style="color: rgb(242, 240, 223);">methodCall</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Method</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">GetParameters</span>()[<span style="color: rgb(242, 240, 223);">i</span>]<span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Name</span>;</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(144, 238, 144);">object</span> <span style="color: rgb(242, 240, 223);">value</span> <span style="color: silver;">=</span> ((<span style="color: rgb(255, 0, 128);">ConstantExpression</span>) <span style="color: rgb(242, 240, 223);">methodCall</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Arguments</span>[<span style="color: rgb(242, 240, 223);">i</span>])<span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Value</span>;</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(255, 0, 128);">Assert</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">That</span>(<span style="color: rgb(242, 240, 223);">routeData</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">Values</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">GetValue</span>(<span style="color: rgb(242, 240, 223);">name</span>), <span style="color: rgb(255, 0, 128);">Is</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">EqualTo</span>(<span style="color: rgb(242, 240, 223);">value</span><span style="color: silver;">.</span><span style="color: rgb(242, 240, 223);">ToString</span>()));</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: rgb(144, 238, 144);">return</span> <span style="color: rgb(242, 240, 223);">routeData</span>;</p>
<p style="margin: 0px;">}</p>
</div>


<p>This might be a tad brittle, but in my preliminary testing it worked wonders.&nbsp; This code is now in <a href="http://mvccontrib.org" target="_blank">MvcContrib</a>&#8217;s TestHelper project.&nbsp;</p>


<div class="wlWriterSmartContent" id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:b04a1ca3-9141-402a-955f-b9b27054f6ac" style="margin: 0px; padding: 0px; display: inline;">Technorati Tags: <a href="http://technorati.com/tags/asp.net%20mvc" rel="tag">asp.net mvc</a></div>

</div>
  <footer>
    <a rel="full-article" href="/blog/2008/11/fluent-route-testing-in-asp-net-mvc/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/11/subsonic-and-projections/">SubSonic and Projections</a></h1>
    
    
      <p class="meta">




<time datetime="2008-11-11 00:00:00 -0600" pubdate  updated >Nov 11<span>th</span>, 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve said in the past that we use SubSonic on my current project.&#160; It does what it says it does (mostly) and generates some usable code off of an existing database.&#160; I do have my qualms about it, mostly because of my bias to look at things from the object/domain world rather than the database world.&#160; But I am a committer, so my energy complaining would be better off contributing goodness to the project.</p>


<p>  <p>With the most recent release of the new query API in SubSonic, we were given a lot of flexibility.&#160; This was much needed in our project because getting single results and collections off of a single entity is rarely sufficient for complex applications.&#160; Often times the data needed to display on a page comes from multiple tables.</p>  <p>In the past, I was forced to do this sort of ugly nastiness:</p></p>

<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>&lt;span class="rem">//get schedules (1 query)&lt;/span>
</div><div class='line'>Schedule[] schedules = _repository.GetSchedulesInRange(start, end);
</div><div class='line'>&lt;span class="rem">//get employee info (2 queries)&lt;/span>
</div><div class='line'>Employee[] employees = _repository.GetEmployeesInSchedules(schedules);
</div><div class='line'>ScheduleDisplayMapper mapper = &lt;span class="kwrd">new&lt;/span> ScheduleDisplayMapper();
</div><div class='line'>&lt;span class="kwrd">return&lt;/span> mapper.Map(schedules, employees);</div></code></pre></td></tr></table></div></figure></div>




<p>This function returned an array of `ScheduleDTO` objects that were used to bind to a view.&#160; The lack of joins at the database level was really killing our productivity and in some cases, performance.&#160; It often took more code to write the query than you&#8217;d expect, because you would have to perform it in steps.</p>


<blockquote>
<p>Note: I&#8217;m really pragmatic about performance, so 2 queries when 1 is possible doesn&#8217;t usually matter in the long run.&#160; Of course if this *is* a perf bottleneck, then of course, optimize.&#160; I much prefer to balance programmer performance over unnoticeable application performance.</p>
</blockquote>


<p>With the new query API, I can now do this:</p>




<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
<span class='line'>7</span>
<span class='line'>8</span>
<span class='line'>9</span>
<span class='line'>10</span>
<span class='line'>11</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>SqlQuery query = &lt;span class="kwrd">new&lt;/span> Select()
</div><div class='line'>.From&lt;OnCallSchedule&gt;()
</div><div class='line'>.InnerJoin(Area.AreaIdColumn, OnCallSchedule.AreaIdColumn)
</div><div class='line'>.InnerJoin(EmployeeProfile.EmployeeProfileIdColumn, OnCallSchedule.EmployeeProfileIdColumn)
</div><div class='line'>.Where(OnCallSchedule.StartDtColumn).IsLessThanOrEqualTo(date)
</div><div class='line'>.And(OnCallSchedule.EndDtColumn).IsGreaterThanOrEqualTo(date)
</div><div class='line'>.OpenExpression()
</div><div class='line'>.And(Area.AreaIdColumn).IsNull()
</div><div class='line'>.Or(Area.AreaIdColumn).IsEqualTo(areaId)
</div><div class='line'>.CloseExpression()
</div><div class='line'>.OrderAsc(OnCallSchedule.PriorityColumn.ColumnName);</div></code></pre></td></tr></table></div></figure></div>




<p>I get complete refactoring support, intellisense, and type-safety.&#160; But now we have a different problem:&#160; we&#8217;re not returning a single entity anymore.&#160; We&#8217;re returning a combination of columns from different tables.</p>


<p>To build my DTO objects, I then had to resort to functions like this:</p>




<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
<span class='line'>7</span>
<span class='line'>8</span>
<span class='line'>9</span>
<span class='line'>10</span>
<span class='line'>11</span>
<span class='line'>12</span>
<span class='line'>13</span>
<span class='line'>14</span>
<span class='line'>15</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>&lt;span class="kwrd">public&lt;/span> &lt;span class="kwrd">static&lt;/span> ScheduleDTO FetchFromRow(IDataReader dr)
</div><div class='line'>{
</div><div class='line'>&lt;span class="kwrd">int&lt;/span> i = 0;
</div><div class='line'>ScheduleDTO schedule = &lt;span class="kwrd">new&lt;/span> ScheduleDTO();
</div><div class='line'>schedule.OnCallScheduleId = dr.GetGuid(i++);
</div><div class='line'>schedule.Start = dr.GetDateTime(i++);
</div><div class='line'>schedule.End = dr.GetDateTime(i++);
</div><div class='line'>schedule.Comments = dr[i++] &lt;span class="kwrd">as&lt;/span> &lt;span class="kwrd">string&lt;/span>;
</div><div class='line'>schedule.Priority = dr.GetInt32(i++);
</div><div class='line'>schedule.EmployeeProfileId = dr.GetGuid(i++);
</div><div class='line'>&lt;span class="kwrd">string&lt;/span> firstName = dr.GetString(i++);
</div><div class='line'>&lt;span class="kwrd">string&lt;/span> lastName = dr.GetString(i++);
</div><div class='line'>schedule.EmployeeName = firstName + &lt;span class="str">&quot; &quot;&lt;/span> + lastName;
</div><div class='line'>&lt;span class="kwrd">return&lt;/span> schedule;
</div><div class='line'>}</div></code></pre></td></tr></table></div></figure></div>




<p><strong>Excuse me while I go vomit</strong>.&#160; This code gives me nightmares from the days when I wrote my own data access layer by hand.&#160; We as programmers should never be writing code that is simply of the form <em>copy this value to that value.&#160; Cast X to Y</em>.&#160; It&#8217;s specifically the reason why data binding exists for forms.</p>


<p>After writing two of these methods I decided we need to come up with a better way.&#160; I wanted to declaratively say, this <em>DTO maps to these columns</em>.&#160; We don&#8217;t have .NET 3.5, so magic-y lambda syntax is out.</p>


<p>I decided to lean on attributes.&#160; Yes, this does add some &quot;database-y&quot; things on my DTOs, but I figured the baggage was worth it.&#160; I created a custom attribute to map properties on my DTOs to columns on a result set.</p>


<p></p>




<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
<span class='line'>7</span>
<span class='line'>8</span>
<span class='line'>9</span>
<span class='line'>10</span>
<span class='line'>11</span>
<span class='line'>12</span>
<span class='line'>13</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>[AttributeUsage(AttributeTargets.Property)]
</div><div class='line'>&lt;span class="kwrd">public&lt;/span> &lt;span class="kwrd">class&lt;/span> MapToColumnAttribute : Attribute
</div><div class='line'>{
</div><div class='line'>&lt;span class="kwrd">private&lt;/span> &lt;span class="kwrd">readonly&lt;/span> &lt;span class="kwrd">string&lt;/span> _columnName;
</div><div class='line'>&lt;span class="kwrd">public&lt;/span> MapToColumnAttribute(&lt;span class="kwrd">string&lt;/span> columnName)
</div><div class='line'>{
</div><div class='line'>_columnName = columnName;
</div><div class='line'>}
</div><div class='line'>&lt;span class="kwrd">public&lt;/span> &lt;span class="kwrd">string&lt;/span> ColumnName
</div><div class='line'>{
</div><div class='line'>get { &lt;span class="kwrd">return&lt;/span> _columnName; }
</div><div class='line'>}
</div><div class='line'>}</div></code></pre></td></tr></table></div></figure></div>




<p></p>


<p>Now to decorate my DTO&#8230;.</p>


<p></p>




<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
<span class='line'>7</span>
<span class='line'>8</span>
<span class='line'>9</span>
<span class='line'>10</span>
<span class='line'>11</span>
<span class='line'>12</span>
<span class='line'>13</span>
<span class='line'>14</span>
<span class='line'>15</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>&lt;span class="kwrd">public&lt;/span> &lt;span class="kwrd">class&lt;/span> ScheduleDTO
</div><div class='line'>{
</div><div class='line'>[MapToColumn(OnCallSchedule.Columns.Priority)]
</div><div class='line'>&lt;span class="kwrd">public&lt;/span> &lt;span class="kwrd">int&lt;/span> Priority
</div><div class='line'>{
</div><div class='line'>get { &lt;span class="kwrd">return&lt;/span> _priority; }
</div><div class='line'>set { _priority = &lt;span class="kwrd">value&lt;/span>; }
</div><div class='line'>}
</div><div class='line'>[MapToColumn(EmployeeProfile.Columns.EmployeeProfileId)]
</div><div class='line'>&lt;span class="kwrd">public&lt;/span> Guid ProfileId
</div><div class='line'>{
</div><div class='line'>get { &lt;span class="kwrd">return&lt;/span> _profileId; }
</div><div class='line'>set { _profileId = &lt;span class="kwrd">value&lt;/span>; }
</div><div class='line'>}
</div><div class='line'>&lt;span class="rem">/* snip */&lt;/span></div></code></pre></td></tr></table></div></figure></div>




<p></p>


<p>SubSonic has a struct called <em>Columns</em> that contains all of the column names. I had to edit the default template to make these constants rather than statics, so that they would be usable in the attribute constructors.</p>


<p>Now that all of the mapping information has been provided declaratively, I can now leverage a generic mapper class to do the copying form DataReader over to DTO.</p>


<p></p>




<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
<span class='line'>7</span>
<span class='line'>8</span>
<span class='line'>9</span>
<span class='line'>10</span>
<span class='line'>11</span>
<span class='line'>12</span>
<span class='line'>13</span>
<span class='line'>14</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>&lt;span class="kwrd">public&lt;/span> T Map&lt;T&gt;(IDataReader dr) &lt;span class="kwrd">where&lt;/span> T : &lt;span class="kwrd">new&lt;/span>()
</div><div class='line'>{
</div><div class='line'>Type type = &lt;span class="kwrd">typeof&lt;/span>(T);
</div><div class='line'>T target = &lt;span class="kwrd">new&lt;/span> T();
</div><div class='line'>&lt;span class="kwrd">foreach&lt;/span>(PropertyInfo property &lt;span class="kwrd">in&lt;/span> type.GetProperties())
</div><div class='line'>{
</div><div class='line'>&lt;span class="kwrd">foreach&lt;/span>(MapToColumnAttribute attr &lt;span class="kwrd">in&lt;/span> ReflectionUtil.GetAttributes&lt;MapToColumnAttribute&gt;(property))
</div><div class='line'>{
</div><div class='line'>&lt;span class="kwrd">object&lt;/span> &lt;span class="kwrd">value&lt;/span> = dr[attr.ColumnName];
</div><div class='line'>property.SetValue(target, &lt;span class="kwrd">value&lt;/span>, &lt;span class="kwrd">null&lt;/span>);
</div><div class='line'>}
</div><div class='line'>}
</div><div class='line'>&lt;span class="kwrd">return&lt;/span> target;
</div><div class='line'>}</div></code></pre></td></tr></table></div></figure></div>




<p></p>


<p>This function takes a DataReader that currently on a record, loops over the properties of the DTO looking for our attribute.&#160; It then sets the value using reflection.&#160; The beauty of this is, I don&#8217;t have to worry about casting anything.&#160; As long as the types of the columns match up with the type of the property, then we&#8217;re golden.</p>


<p>The act of mapping projections of entities onto flat data transfer objects is now incredibly simple:</p>


<p></p>




<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>ProjectionMapper mapper = &lt;span class="kwrd">new&lt;/span> ProjectionMapper();
</div><div class='line'>&lt;span class="kwrd">using&lt;/span>(IDataReader dr = query.ExecuteReader())
</div><div class='line'>{
</div><div class='line'>&lt;span class="kwrd">while&lt;/span>(dr.Read())
</div><div class='line'>results.Add(mapper.Map&lt;ScheduleDTO&gt;(dr));
</div><div class='line'>}</div></code></pre></td></tr></table></div></figure></div>




<p></p>


<p></p>


<p>You can take this one step further to encapsulate the looping over the data reader as well.</p>


<p>It was a nice feeling to be able to remove 17 lines of query code and 1 40 line mapping class and replace it with a tighter query and a few attributes.</p>


<p>Deleting code is fun.</p>


<div class="wlWriterSmartContent" id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:226b7435-322b-43b9-b942-f3fbbede0838" style="padding-right: 0px; display: inline; padding-left: 0px; padding-bottom: 0px; margin: 0px; padding-top: 0px">Technorati Tags: <a href="http://technorati.com/tags/SubSonic" rel="tag">SubSonic</a></div>

</div>
  <footer>
    <a rel="full-article" href="/blog/2008/11/subsonic-and-projections/">Read on &rarr;</a>
  </footer>


  </article>

<nav role="pagination">
  <div>
    
      <a class="prev" href="/blog/page/11/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/9/">Newer &rarr;</a>
    
  </div>
</nav>

<script type="text/javascript">
    var disqus_shortname = 'subdigital';
    (function () {
      var s = document.createElement('script'); s.async = true;
      s.type = 'text/javascript';
      s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
      (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

</div>
<aside role=sidebar>
  
    <section>
  <h1>Who am I?</h1>
  <p>I&#8217;m Ben Scheirman. I make Rails &amp; iPhone apps for <a href="http://chaione.com" target="_blank">ChaiONE</a> in Houston, TX.</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2011/08/vim---could-not-invoke-jslint/">Vim - Could Not Invoke JSLint</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/08/is-rails-exempt-from-software-principles/">Is Rails Exempt?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/08/when-viewwillappear-isnt-called/">When viewWillAppear: Isn&#8217;t Called</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/08/moving-my-blog/">Moving My Blog</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/08/my-vim-journey/">My Vim Journey</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("subdigital", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/subdigital" class="twitter-follow-button" data-width="208px" data-show-count="false">Follow @subdigital</a>
  
</section>


<section>
  <h1>On Delicious</h1>
  <script type="text/javascript" src="http://feeds.delicious.com/v2/js/subdigital?title=&count=3&sort=date&extended"></script>
  <p><a href="http://delicious.com/subdigital">My Delicious Bookmarks &raquo;</a></p>
</section>



  
</aside>

    </div>
  </div>
  <footer>
<a style="display:block; float: right" title="Real Time Analytics" href="http://getclicky.com/66470389"><img alt="Real Time Analytics" src="//static.getclicky.com/media/links/badge.gif" border="0" /></a>
<script src="//static.getclicky.com/js" type="text/javascript"></script>
<script type="text/javascript">try{ clicky.init(66470389); }catch(e){}</script>
<noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/66470389ns.gif" /></p></noscript>

<p>
  Copyright &copy; 2011 - Ben Scheirman -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
</body>
</html>
