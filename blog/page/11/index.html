
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Fickle Bits</title>
  <meta name="author" content="Ben Scheirman">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="canonical" href="http://benscheirman.com/blog/page/11/index.html"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="http://s3.amazonaws.com/ender-js/jeesh.min.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/ficklebits" rel="alternate" title="Fickle Bits" type="application/atom+xml"/>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-210379-10']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  
  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>


  
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>

</head>

<body  >
  <header><hgroup>
  <h1><a href="/">Fickle Bits</a></h1>
  
    <h2>You're doing it wrong.</h2>
  
</hgroup>

</header>
  <nav role=navigation><ul role=subscription data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/ficklebits" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:benscheirman.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">



  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/11/photos/">Photos</a></h1>
    
    
      <p class="meta">




<time datetime="2008-11-11 00:00:00 -0600" pubdate  updated >Nov 11<span>th</span>, 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p><em>This album displays photos from my <a target="_blank" href="http://flickr.com/photos/bensilvia">Flickr</a> account.</em></p>

</div>
  <footer>
    <a rel="full-article" href="/blog/2008/11/photos/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/11/new-blog-design-platform/">New Blog Design / Platform</a></h1>
    
    
      <p class="meta">




<time datetime="2008-11-10 00:00:00 -0600" pubdate  updated >Nov 10<span>th</span>, 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p>My blog is now running on <a href="http://graffiticms.com">Graffiti</a>. &nbsp;I also updated the design a little bit. &nbsp;I decided that after the lack of stability on my VPS with <a href="http://godaddy.com">Go Daddy</a> that I&#8217;d try out a real host. &nbsp;So I&#8217;ve moved my blog over to <a href="http://www.orcsweb.com">ORCS Web</a>. &nbsp;So far, things are great.</p>


<p>Graffiti has a tool to import posts from DasBlog, which is nice, however I wanted to preserve all of my old posts. &nbsp;A simple lookup table, joined with the new Graffiti Posts table gave me the information I needed to map the URLs. &nbsp;Then I created an HttpModule to intercept requests for the old URLs and 301 redirect them to the new ones.</p>


<p>I tested about 20 URLs and it worked fine for me, but if you notice a post that no longer works, please let me know!</p>


<p>What do <em>you</em> think of the new blog?</p>

</div>
  <footer>
    <a rel="full-article" href="/blog/2008/11/new-blog-design-platform/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/11/contact/">Contact</a></h1>
    
    
      <p class="meta">




<time datetime="2008-11-09 00:00:00 -0600" pubdate  updated >Nov 9<span>th</span>, 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p>Fill out the form below to get in touch with me.</p>

</div>
  <footer>
    <a rel="full-article" href="/blog/2008/11/contact/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/11/book/">Book</a></h1>
    
    
      <p class="meta">




<time datetime="2008-11-09 00:00:00 -0600" pubdate  updated >Nov 9<span>th</span>, 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p><strong>Update: &nbsp;The book is finished! &nbsp;You can purchase it at <a href="http://manning.com/palermo">Manning</a> or <a href="http://www.amazon.com/ASP-NET-MVC-Action-Jeffrey-Palermo/dp/1933988622/ref=sr_1_5?ie=UTF8&amp;s=books&amp;qid=1250604657&amp;sr=8-5">Amazon</a>.</strong></p>


<p><img alt="" src="http://jeffreypalermo.com/files/media/image/WindowsLiveWriter/ASP.NETMVCinActionbookcompleteandheadedt_7A74/image_caa2976c-de99-4b61-a7c8-7a32ef519518.png" />&nbsp;I&#8217;m currently writing a book called ASP.NET MVC in Action with <a target="_blank" href="http://www.jeffreypalermo.com">Jeffrey Palermo</a> and <a href="http://www.lostechies.com/blogs/jimmy_bogard/">Jimmy Bogard</a>. &nbsp;You can get early PDFs from <a href="http://manning.com/palermo">Manning&#8217;s Early Access Program</a>. &nbsp;If you&#8217;re interested in ASP.NET MVC, be sure to pick it up!</p>


<p>The book will not be your typical introductory text. &nbsp;Instead, we&#8217;re focusing on realistic usage, such as encouraging &amp; facilitating test-driven development, leveraging inversion of control frameworks, and adhering to good software development principles like Single Responsibility.</p>


<p>You can take a look at our sample application for the book, <a target="_blank" href="http://codecampserver.org">Code Camp Server</a>.</p>

</div>
  <footer>
    <a rel="full-article" href="/blog/2008/11/book/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/11/about-me/">About Me</a></h1>
    
    
      <p class="meta">




<time datetime="2008-11-01 00:00:00 -0500" pubdate  updated >Nov 1<span>st</span>, 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p>My name is Ben Scheirman. &nbsp;I am the Director of Development at <a href="http://www.chaione.com">ChaiONE</a> in Houston, TX.</p>


<p>I started out programming when I was 13, tinkering with QBASIC and creating simple games and screensavers. &nbsp;My favorite experience was creating a fake application called &quot;DELBUG&quot; that &quot;removes bugs from programs.&quot; &nbsp;It proceeded to tell the user that it had no choice but to format their hard drive. &nbsp;After that, I was hooked.</p>


<p>I took Computer Science classes all through high school, and then took the passion to college as well.&nbsp; I received a Bachelor&#8217;s degree in Computer Science from the University of Houston in 2004.</p>


<p>On this blog you&rsquo;ll find my random tidbits about software development as I evolve in my craft. &nbsp;Currently, I&#8217;m interested in agile practices such as test-driven development, refactoring, continuous integration, domain driven design, and more.&nbsp; I also frequently cover object-relational mapping concepts with NHibernate.&nbsp; I&#8217;m highly interested in both web and iPhone development.</p>


<p>My platforms of choice (in no particular order):&nbsp; .NET, Rails, iPhone</p>


<p>Languages:&nbsp; C#, Ruby, Objective-C, JavaScript, Boo</p>


<p>I wrote a   <a href="http://www.amazon.com/gp/product/1933988622?ie=UTF8&amp;tag=flux88com-20&amp;linkCode=as2&amp;camp=1789&amp;creative=390957&amp;creativeASIN=1933988622">book</a><img width="1" height="1" border="0" style="border: medium none ! important; margin: 0px ! important;" alt="" src="http://www.assoc-amazon.com/e/ir?t=flux88com-20&amp;l=as2&amp;o=1&amp;a=1933988622" />&nbsp;(and a <a href="http://manning.com/palermo2/">2nd edition</a>)  and an <a href="http://pockettabs.com">iPhone app</a> that you might want to check out.</p>


<p>I enjoy reading, but the only thing that captures my attention are technical books.&nbsp; My reading list is growing faster than I can possibly read them! &nbsp;</p>


<p>I live in Houston with my wife and <strike>three</strike>&nbsp;<strong>five</strong> beautiful children.&nbsp; When I&rsquo;m not working, I&rsquo;m usually hanging out with my family, playing video games, or playing guitar.</p>


<p>Thanks for looking!</p>

</div>
  <footer>
    <a rel="full-article" href="/blog/2008/11/about-me/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/10/leveraging-existing-asp-net-features-in-asp-net-mvc/">Leveraging Existing ASP.NET Features in ASP.NET MVC</a></h1>
    
    
      <p class="meta">




<time datetime="2008-10-20 00:00:00 -0500" pubdate  updated >Oct 20<span>th</span>, 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p><em>The following is an excerpt from my upcoming book, </em><a href="http://manning.com/palermo" target="_blank"><em>ASP.NET MVC in Action</em></a><em>&#8230;</em></p>


<p>Many of us have invested heavily in ASP.NET. With ASP.NET MVC now available as an alternative to WebForms, is all that knowledge lost? Do we have to relearn this platform entirely from scratch? You&#8217;ll be relieved to know that many of ASP.NET&#8217;s platform features work the same way they always have. Some ASP.NET server controls even work. In this chapter we&#8217;ll cover what works in ASP.NET MVC and what does not. By the end of the chapter, you should feel comfortable leveraging your existing knowledge of ASP.NET to build robust web sites with ASP.NET MVC.</p>


<h2>8.1 ASP.NET Server Controls</h2>


<p>As you just discovered, some ASP.NET server controls work with ASP.NET MVC, but which ones? How can we tell if a control will work or not? To put it simply, any control that depends on ViewState or generates post-backs will not work. Some controls will render, but they require a &lt;form runat=&#8221;server&#8221;&gt; which you might not want to add. Adding a server-side form tag will put hidden fields on the page for ViewState and event validation. The form will also POST to the same action you&#8217;re on, which is usually unacceptable.</p>


<blockquote> <h4>Note:</h4><p>The code you&#8217;ll read in this section is purely exploratory. Most of it contains hacks and other workarounds that go against the intended design of an MVC web application. The intent of this section is to see how far we can bend the framework without breaking it. Your authors would not recommend using most of these methods in a production application unless absolutely necessary.</p> </blockquote>


<h3><a name="_Toc212290640">8.1.1 The TextBox</a></h3>


<p>The first control we&#8217;ll examine is the &lt;asp:TextBox /&gt;. It renders as an &lt;input /&gt; HTML element. It requires a &lt;form runat=&#8221;server&#8221;&gt; tag to function, and will be given a generated ID, again which is what we&#8217;re trying to avoid here! Since it is a form field, and the form is required to be runat=&#8221;server&#8221;, it is crippled in its function. Figure 8.1 shows it in action, while Listing 8.1 shows the resulting HTML.</p>


<p><img src="/images/figure8_1_.png" alt="figure8_1"  border="0"  />&#160; <br /><strong>Figure 8.1 - The TextBox renders correctly</strong></p>


<p><strong>Listing 8.2 - The resulting HTML for the TextBox is less than desirable</strong> </p>


<p><img src="/images/figure8_2_.png" alt="figure8_2"  border="0"  /> </p>


<p>We can see here that the rendered HTML contains a lot of things that we didn&#8217;t ask for. In addition, notice that the form tag has an action attribute that we didn&#8217;t specify. This will prevent the form from submitting to an action that we request. Since a textbox in ASP.NET MVC is as simple as &lt;%= Html.TextBox(&#8220;name&#8221;) %&gt;, the TextBox server control offers no functionality - only baggage - for your ASP.NET MVC views.</p>


<h3>8.1.2 Other Common Controls</h3>


<p>We can see from our simple text box example that most ASP.NET WebForms input controls have little to offer. However, some of the controls have very functional rendered output. An excellent example is the &lt;asp:Menu /&gt; control. It doesn&#8217;t require or generate any post-backs and it doesn&#8217;t require view state. It simply renders HTML and JavaScript to allow elements to expand and hide on mouse events. Leaving aside that the &lt;asp:Menu /&gt; renders a nasty pile of HTML tables to display properly, it&#8217;s purely a client rendered control, and it works just fine in ASP.NET MVC. Luckily we can fix the poor markup with ASP.NET Control Adapters, which also function in ASP.NET MVC. Figure 8.3 demonstrates the menu control.</p>


<p><img src="/images/figure8_3_.png" alt="figure8_3"  border="0"  /> </p>


<p><strong>Figure 8.3 - The menu control renders, unfortunately the links require post-backs. More surgery is needed to make it function.</strong></p>


<p><img src="/images/figure8_4_.png" alt="figure8_4"  border="0"  /> </p>


<p><strong>Figure 8.4 - The horrific markup that is rendered by the Menu control. Stay tuned for a better way.</strong></p>


<p>While the &lt;asp:Menu /&gt; control renders properly, the links in the menu are post-back links, and don&#8217;t work. We could conjure up some javascript to alter this behavior, however doing so would just add to the mess. Additionally, take a look at the rendered markup in Figure 8.4. Hard-coded styles, deeply nested tables, highly obtrusive javascript make this tiny menu render nothing short of a headache. </p>


<blockquote> <p><strong>Note:</strong></p><p>This type of markup is a constant reminder of why we want more control over our HTML! Later, in Chapter 14 (Recipes) we&#8217;ll see how we can do much better. For now, let&#8217;s continue on with our exploration of ASP.NET server controls. </p> </blockquote>


<p>Two controls that would be hard to live without would be the &lt;asp:TreeView /&gt; and the &lt;asp:Calendar /&gt;. The TreeView works fairly well, however it generates post-backs that do nothing. The visual aspect works just fine, however. The calendar relies heavily on post-back for navigation, so unfortunately it does not function in ASP.NET MVC.</p>


<p>I&#8217;ve so far neglected the big-daddy of ASP.NET server controls. That&#8217;s right; I&#8217;m talking about the GridView. The GridView is an interesting case, because it has so many different forms. At its simplest, the GridView is just an HTML table. It&#8217;s great for displaying tabular data. If we don&#8217;t require any post-back, then it should work, right? In short it does work, however there are a view gotchas along the way.</p>


<h3>8.1.3 The GridView</h3>


<p>The first issue you face is there is no declarative way to bind the GridView to data coming from ViewData. For this we can poke into the code-behind class, which up until now has been mostly useless. In standard ASP.NET Form, you can add an OnLoad event handler and set the grid&#8217;s DataSource property to the data coming from ViewData. Listing 8.1 shows how you might accomplish this. Another method you could employ is to take the data binding code and put it directly in the view markup, inside &lt;% %&gt; code blocks. Listing 8.2 demonstrates this. Both of these methods send bad vibes up my spine, but the point is that it is possible.</p>


<p><strong>Listing 8.1 - Binding a GridView from the code-behind</strong></p>


<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>public partial class grid : ViewPage&lt;Customer[]&gt;{ protected override void OnLoad(System.EventArgs e) {base.OnLoad(e);grid1.DataSource = ViewData.Model;grid1.DataBind(); }}</div></code></pre></td></tr></table></div></figure></div>


<p><strong>Listing 8.2 - Binding a GridView from the view itself</strong></p>


<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>&lt;% grid1.DataSource = ViewData.Model; grid1.DataBind();%&gt;</div></code></pre></td></tr></table></div></figure></div>


<p>You also have the option of using the DataSource controls such as ObjectDataSource, SqlDataSource, and XmlDataSource. Of course, in doing this you&#8217;ve completely circumvented the MVC pattern and placed all of your data access directly in the view!</p>


<p><img src="/images/figure8_5_.png" alt="figure8_5"  border="0"  /> </p>


<p><strong>Figure 8.5 - The GridView ren
ders properly</strong></p>


<p>Figure 8.5 shows our newly bound GridView in action. Unfortunately, that&#8217;s all you get, because none of the advanced features of the GridView will work. No sorting, paging, editing, or selecting. Because of this, it is of limited utility, and will probably only aid you during prototyping and demos.</p>


<p>All is not lost, however. In ASP.NET MVC you can achieve the holy grail of an editable data grid, complete with sorting, paging, and editing. You just have to structure it in a different way. You&#8217;ll see an example of this in Chapter 14 (Recipes).</p>


<p><a name="_Toc212290643">8.1.4 So Where Do I Get The Good Stuff?</a></p>


<p>The examples I&#8217;ve shown here might give you a sour taste in your mouth about ASP.NET MVC. Before you scoff at it and decide that you don&#8217;t want to live without your TreeView and Menu controls, consider this: many thousands of samples online show how you can achieve the same functionality with a little bit of Javascript and CSS. These are freely available solutions that many other platforms leverage. With ASP.NET MVC we can do the same, and with minimal friction in applying it. Often, these solutions are so simple; they make the declarative ASP.NET controls look like a sledgehammer. Here are a few references for platform-agnostic solutions to tree views, menus, and tabs using jQuery.</p>


<table cellspacing="0" cellpadding="4" border="0"><tbody><tr><td>jQuery Treeview Example</td><td><a href="http://jquery.bassistance.de/treeview/demo/">http://jquery.bassistance.de/treeview/demo/</a></td></tr><tr><td valign="top"><p>jQuery Menu Example</p></td><td><a href="http://jdsharp.us/jQuery/plugins/jdMenu/">http://jdsharp.us/jQuery/plugins/jdMenu/</a></td></tr><tr><td>jQuery Tabs Example</td><td><p><a href="http://stilbuero.de/jquery/tabs/">http://stilbuero.de/jquery/tabs/</a></p></td></tr></tbody></table>


<p>&#160;</p>


<p>______________________________</p>


<p>For more early sections of ASP.NET MVC in Action, check out the pre-release PDFs available at <a href="http://manning.com/palermo" target="_blank">Manning Press</a>.</p>


<p>My co-authors may also be posting some excerpts, so pay attention to them:&#160; <a href="http://www.jeffreypalermo.com" target="_blank">Jeffrey Palermo</a> and <a href="http://www.lostechies.com/blogs/jimmy_bogard/" target="_blank">Jimmy Bogard</a>.</p>

</div>
  <footer>
    <a rel="full-article" href="/blog/2008/10/leveraging-existing-asp-net-features-in-asp-net-mvc/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/10/vs-live-tulsa-techfest-material/">Vs Live / Tulsa TechFest Material</a></h1>
    
    
      <p class="meta">




<time datetime="2008-10-14 00:00:00 -0500" pubdate  updated >Oct 14<span>th</span>, 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p>I just wrapped up my session on Test-Driven Development with ASP.NET MVC.&nbsp; The audience was a bit thin, but the people who were there seemed genuinely interested in both ASP.NET MVC and Test Driven Development.</p>


<p> <p>I had a little hiccup during the demo, so I had to comment out my Windsor code &amp; just revert to poor man&#8217;s dependency injection!&nbsp; What&#8217;s weird is that this worked 20 minutes before the demo, but whatever.</p> <p>Another thing to note is that I&#8217;m now a BDD convert, so my tests changed a bit from the material that was delivered on DVD over a month ago.&nbsp; The example I did today, with BDD style tests &amp; some ShouldBe extension methods is available here:</p> <p><a href="http://benscheirman.googlecode.com/files/vslive%20las%20vegas%202008.zip" target="_blank">VS Live Presentation Material</a></p> <p>I also ended up winning a little bit of money yesterday, which was awesome!&nbsp; While playing nickel slots and talking on the phone to my wife, I accidentally pressed the cash out button when I only had $0.10 left :)&nbsp; Here&#8217;s a stellar picture showing my excitement:</p> <p><a href="http://flux88.com/uploads/VSLiveTulsaTechFestMaterial_9BAA/lasvegaswinnings.png"><img src="/images/lasvegaswinnings_thumb_.png" alt="las-vegas-winnings"  border="0" /></a> </p> <h2>Tulsa TechFest</h2> <p>Also, last week I gave two presentations in Tulsa:</p> <ul> <li>Become a .NET Jedi with ReSharper</li> <li>Build a blog with ASP.NET MVC</li></ul> <p>The audiences for both talks were very engaged, and I think they both went really well.&nbsp; I did leave Tulsa wondering, however, <strong>what&#8217;s with all the VB developers!</strong>&nbsp; (I kid, I kid!)</p> <p>The material for the blog example is available here:</p> <p><a href="http://benscheirman.googlecode.com/files/vslive%20las%20vegas%202008.zip" target="_blank">Tulsa TechFest Presentation Material</a></p> <p>If you want to browse the source for either of these talks, check out <a href="http://code.google.com/p/benscheirman" target="_blank">my google code repository</a> (they&#8217;ll be posted soon).</p> <p>Thanks to those who attended my talks &amp; game me valuable feedback.&nbsp; I&#8217;m always looking to improve my presentation skills.</p> <p>&nbsp;</p> <p>What&#8217;s next for me?&nbsp; I&#8217;ll be speaking at the <a href="http://www.innotechok.com/" target="_blank">Innotech</a> in Oklahoma City on November 6th, on the same subject.</p></p>
</div>
  <footer>
    <a rel="full-article" href="/blog/2008/10/vs-live-tulsa-techfest-material/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/10/the-transition-from-tdd-to-bdd/">The Transition From TDD to BDD</a></h1>
    
    
      <p class="meta">




<time datetime="2008-10-12 00:00:00 -0500" pubdate  updated >Oct 12<span>th</span>, 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p><a href="http://flux88.com/uploads/TheTransitionfromTDDtoBDD_13B13/butterfly.jpg"><img src="/images/butterfly_thumb_.jpg" alt="butterfly"  border="0" /></a> I&#8217;ve been a long practitioner of test-driven development (TDD). I first started unit testing back in 2004, and it made a profound effect on me.&nbsp; It was incredibly difficult, however and I began to look for ways to make my code more testable. This brought me to TDD, which guided me towards looser-coupled systems that were testable from the get-go (since we started out testing it!)</p>


<p> <p>Things in the TDD world aren&#8217;t all peach schnapps and roses (or however the saying goes). Often times you still end up with messy tests that have tons of code duplication and very little solubility. TDD is still difficult for me, even though I&#8217;ve done it for 4 years.</p> <p>One thing I&#8217;ve noticed lately that I&#8217;ve been slowly losing in my tests is the executable documentation. It&#8217;s increasingly hard to tell how my system behaves just from reading my unit tests. As our system grew more complex, so did our unit tests and eventually they lost most of their grokability.</p> <p>Another thing I&#8217;ve noticed is that our tests have so much setup gunk that it clouds the meaning of each test method. By nature each test likely has some particular context in which it intends to run, and this code gets placed in the [Test] itself rather than the [SetUp]. Why?&nbsp; My mocks need to behave differently in each test method, so if I put them in the setup, things either don&#8217;t work for other tests or there are mocks being set up that are never used for other tests. I directly attribute this to having one [TestFixture] per system under test.</p> <p>I&#8217;d like to state that again, because it bears repeating. <strong>One TestFixture per system under test is an anti-pattern.</strong> It has taken me three (3!) presentations on Behavior-Driven Design for this fact to really sink in.&nbsp; Contexts are important, and a system that you want to test certainly has more than one context. By separating the fixtures into per-system-context rather than per-system, we can now leverage our [Setup] again to establish our context!</p> <p>Here is a test class that I might have written with a strict TDD mindset:</p></p>

<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>//PostControllerTester.cs</div></code></pre></td></tr></table></div></figure></div>




<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>[Test]&lt;br>public void edit_action_gets_post_from_repository()&lt;br>{&lt;br>&nbsp;&nbsp;&nbsp; _authService.Stub(x=&gt;x.IsAuthorizedToEdit("bob"))&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .IgnoreArguments()&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Return(true); &lt;p>&nbsp;&nbsp;&nbsp; var controller = CreatePostController();&lt;br>&nbsp;&nbsp;&nbsp; controller.Edit(5);&lt;br>&nbsp;&nbsp;&nbsp; _repository.AssertWasCalled(x=&gt;x.Find(5));&lt;br>}&lt;/p></div></code></pre></td></tr></table></div></figure></div>


<p>Notice that this test actually has some setup, some sort of action (in this case we&#8217;re invoking the Edit action), and some verification.&nbsp; This test has 3 pieces to it!&nbsp; Applying a more BDD mindset, you&#8217;d likely have something like this:</p>


<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>public class when_invoking_edit_action_as_authorized_user()&lt;br>{&lt;br>&nbsp;&nbsp;&nbsp; ...&lt;br>&nbsp;&nbsp;&nbsp; [SetUp]&lt;br>&nbsp;&nbsp;&nbsp; public void Setup&lt;br>&nbsp;&nbsp;&nbsp; {&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _controller = new PostsController(...);&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _authService = MockRepository.GenerateMock&lt;IAuthService&gt;();&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _repository = MockRepository.GenerateMock&lt;IPostRepository&gt;();&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EstablishContext();&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; When();&lt;br>&nbsp;&nbsp;&nbsp; }&lt;br>&nbsp;&nbsp;&nbsp; public void EstablishContext()&lt;br>&nbsp;&nbsp;&nbsp; {&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _authService.Stub(x=&gt;x.IsAuthorizedToEdit("bob"))&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .IgnoreArguments().Return(true);&lt;br>&nbsp;&nbsp;&nbsp; }&lt;br>&nbsp;&nbsp;&nbsp; public void When()&lt;br>&nbsp;&nbsp;&nbsp; {&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _controller.Edit(5);&nbsp;&nbsp;&nbsp; &lt;br>&nbsp;&nbsp;&nbsp; }&lt;br>&nbsp;&nbsp;&nbsp; [Test]&lt;br>&nbsp;&nbsp;&nbsp; public void it_should_fetch_post_from_repository()&lt;br>&nbsp;&nbsp;&nbsp; {&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _repository.AssertWasCalled(x=&gt;x.Find(5));&lt;br>&nbsp;&nbsp;&nbsp; }&lt;br>}</div></code></pre></td></tr></table></div></figure></div>


<p>Notice the name of the class.&nbsp; It describes the context of what we&#8217;re trying to accomplish.&nbsp; Our [SetUp] now establishes the state of the environment in which we want to act on our system.&nbsp; The When() method is where we act on our system.&nbsp; The only thing remaining is the test which is now dead simple.&nbsp; The test simply verifies some aspect of the system.&nbsp; The name of the test is also only conveying the verification part of the test.</p>


<p>We can now easily glance at this test (or spec, which it is sometimes called) and read it like english:</p>


<blockquote><p>When invoking the edit action as an authorized user, it should should fetch the post from the repository.</p></blockquote>


<p>This looks awfully close to acceptance criteria that we write for our user stories.&nbsp; </p>


<p>Any acceptance tests that share the same context can reside in the same fixture.&nbsp; It&#8217;s perfectly normal to have 1 test per fixture, but at times you&#8217;ll find that you can have 2 or 3 that indeed share the same context, and those can reside in the same fixture class.</p>


<p>&nbsp;</p>


<h3>BDD Frameworks</h3>


<p>There are plenty of BDD frameworks out there that will do their best to impose their view of BDD on you, and this can seriously hinder your ability to naturally understand the why/how of BDD.&nbsp; Later on, once you have your own opinions, you can leverage a framework (such as MSpec) to have a more terse syntax for describing behaviors in your system.</p>


<h3>BDD Base Class</h3>


<p>Until you get BDD, stick to what you know.&nbsp; In my example I call EstablishContext() and When(), and I&#8217;ll do that for every fixture.&nbsp; Why not leverage a base class?&nbsp; Here&#8217;s mine:</p>


<div><figure role=code><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class=''><div class='line'>public abstract class Specification&lt;br>{&lt;br>&nbsp;&nbsp;&nbsp; protected Exception ExceptionThrown { get; private set; } &lt;p>&nbsp;&nbsp;&nbsp; &lt;br>[SetUp]&lt;br>&nbsp;&nbsp;&nbsp; public void Setup()&lt;br>&nbsp;&nbsp;&nbsp; {&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EstablishContext(); &lt;p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; When();&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(Exception exc)&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ExceptionThrown = exc;&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&lt;br>&nbsp;&nbsp;&nbsp; } &lt;p>&nbsp;&nbsp;&nbsp; &lt;/p>&lt;p>protected T Mock&lt;T&gt;()&lt;br>&nbsp;&nbsp;&nbsp; {&lt;br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return MockRepository.GenerateMock&lt;T&gt;();&lt;br>&nbsp;&nbsp;&nbsp; } &lt;/p>&lt;p>&nbsp;&nbsp;&nbsp; protected abstract void EstablishContext();&lt;br>&nbsp;&nbsp;&nbsp; protected abstract void When(); &lt;p>&nbsp;&nbsp;&nbsp; &lt;/p>&lt;p>[TearDown]&lt;br>&nbsp;&nbsp;&nbsp; public virtual void TearDown()&lt;br>&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;br>&nbsp;&nbsp;&nbsp; }&lt;br>}&lt;/p></div></code></pre></td></tr></table></div></figure></div>


<p>Now when you inherit from Specification, you are forced to provide implementations of EstablishContext() and When().&nbsp; I also wrap the When() in a try/catch so that you can do things like Assert.WasThrown(&#8230;);</p>


<h3>The BDD Journey</h3>


<p>I&#8217;m still a BDD newbie, but I&#8217;m now sold on it&#8217;s organizational structure and it&#8217;s ability to connect tests back to actual requirements of the system.&nbsp; It provides a clear picture of how to group tests &amp; setup behaviors and combined with the
new RhinoMocks AAA syntax, makes my tests much easier to read.</p>


<p>The tipping point for me was attending <a href="http://codebetter.com/blogs/raymond.lewallen/" target="_blank">Raymond Lewallen</a>&#8217;s BDD talk at <a href="http://techfests.com/tulsa/2008" target="_blank">Tulsa TechFest</a>.&nbsp; I recorded the first hour of it, and <a href="http://www.viddler.com/explore/PhatBoyG/videos/1/" target="_blank">it&#8217;s available up on Viddler</a>.&nbsp; I hope this helps more people understand BDD.&nbsp; I&#8217;ve seen presentations like this before, but it took some practice (and failure!) on my own time to start to see some speed bumps.&nbsp; With this knowledge I was able to ask some direct questions and get (gasp!) direct answers.</p>


<p>While I cannot justify going back and changing 500 or so unit tests to this form, I will ensure that I start writing BDD style specifications for my new production code moving forward. </p>

</div>
  <footer>
    <a rel="full-article" href="/blog/2008/10/the-transition-from-tdd-to-bdd/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/10/tulsa-tech-fest-vs-live/">Tulsa Tech Fest & vs Live</a></h1>
    
    
      <p class="meta">




<time datetime="2008-10-08 00:00:00 -0500" pubdate  updated >Oct 8<span>th</span>, 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p><a href="http://flux88.com/uploads/TulsaTechFestVSLive_148B3/tulsaskyline1_dusk.jpg"><img src="/images/tulsaskyline1_dusk_thumb_.jpg" alt="tulsa-skyline1_dusk"  border="0" /></a> It&#8217;s going to be a busy two weeks!&nbsp; I leave tomorrow for Tulsa to speak at <a href="http://techfests.com/tulsa/2008" target="_blank">Tulsa TechFest</a>.&nbsp; If you haven&#8217;t been to one of these you should really try to make it next time.&nbsp; <a href="http://www.davidlwalker.com/" target="_blank">David Walker</a> truly knows how to put on a good event (as I saw first-hand in 2006) and this year looks even better!&nbsp; There&#8217; a veritable truckload of prizes to give away and of course two days FULL of sessions.</p>


<p> <p>I&#8217;ll be giving two talks:</p> <ul> <li><a href="http://techfests.com/Tulsa/2008/Speakers/BenScheirman/default.aspx" target="_blank">Building a blog with ASP.NET MVC</a><br>This session will focus purely on app building, to give participants a glimpse of what it&#8217;s like to work with the framework.&nbsp; <br><br>I&#8217;m tempted to do this session with NVelocity (rather than the ASPX views that you usually see) &#8211; a twitter poll I did yielded a divided audience.&nbsp; 4 said &#8220;Yes! NVelocity!&#8221; and 4 others said &#8220;You&#8217;ll just confuse people.&#8221;&nbsp; If you have an opinion on the matter, chime in in the comments!<br></li> <li><a href="http://techfests.com/Tulsa/2008/Speakers/BenScheirman/default.aspx" target="_blank">Becoming a .NET Jedi with ReSharper</a><br>I was asked to fill in for a speaker, so I decided to just give an off-the-cuff praise-fest for ReSharper.&nbsp; This tool demos so well, and I&#8217;m happy to recommend it to eager developers looking to improve their craft.</li></ul> <p>&nbsp;</p> <p><a href="http://flux88.com/uploads/TulsaTechFestVSLive_148B3/lasvegas.jpg"><img src="/images/lasvegas_thumb_.jpg" alt="las-vegas"  border="0" /></a></p> <p>The following week, I&#8217;ll be at <a href="http://vslive.com/2008/lasvegas/" target="_blank">VS Live in Las Vegas</a> (Vegas, baby, Vegas!)&nbsp; This is my first time going&nbsp; to Vegas, so I&#8217;m super-pumped.&nbsp; My session at VS Live is on Tuesday morning&#8230;</p> <ul> <li><a href="http://http://vslive.com/2008/lasvegas/webdevelopment.aspx#mvc" target="_blank">Test-Driven Development with ASP.NET MVC</a><br>I&#8217;m excited to give this sort of talk to a larger audience.&nbsp; There are a number of interesting points to talk about with respect to testability in software, and how you can cope with software that is not very testable.&nbsp; This talk will benefit people familiar with ASP.NET MVC where they&#8217;ll learn lots about unit testing, mocks, and test-first development.&nbsp; People experienced with TDD will be able to appreciate the ASP.NET MVC framework, seeing first-hand how testable it is out of the box.</li></ul> <p>If you&#8217;re going to either of these conferences, please come by and chat!</p></p>
</div>
  <footer>
    <a rel="full-article" href="/blog/2008/10/tulsa-tech-fest-vs-live/">Read on &rarr;</a>
  </footer>


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/10/the-curly-brace-tax/">The Curly Brace Tax</a></h1>
    
    
      <p class="meta">




<time datetime="2008-10-05 00:00:00 -0500" pubdate  updated >Oct 5<span>th</span>, 2008</time>


</p>
    
  </header>


  <div class="entry-content"><p><em>(I shamelessly stole this title from a chat with <a href="http://mhinze.com/" target="_blank">Matt Hinze</a>)</em></p>


<p>99% of the examples you see out there for ASP.NET MVC are using WebFormsViewEngine.&#160; That&#8217;s fine, it&#8217;s familiar, it benefits from intellisense, compilation, and refactoring support.&#160; But all of that comes at a price, and that price is (at times) <strong>incredibly wordy</strong>.</p>


<p>Picture this example, taken from the Site.master (master page) in the Preview 5 new project template.</p>


<p>At the top of the page, they want to render some text if the user is logged in, and different text if the user isn&#8217;t logged in.&#160; Here are the screens:</p>


<p><strong>When you&#8217;re not logged in:<br /></strong><a href="http://flux88.com/uploads/TheCurlyBraceTax_FB9D/mvcmasterpagelogin.jpg"><img src="/images/mvcmasterpagelogin_thumb_.jpg" alt="mvc-masterpage-login"  border="0"  /></a> </p>


<p><strong>And when you&#8217;re logged in&#8230;<br /><a href="http://flux88.com/uploads/TheCurlyBraceTax_FB9D/mvcmasterpagelogout.jpg"><img src="/images/mvcmasterpagelogout_thumb_.jpg" alt="mvc-masterpage-logout"  border="0"  /></a> </strong></p>


<p>This is implemented using ASPX code that looks like this:</p>


<p>{% codeblock %}<div id="logindisplay">&lt;%if (Request.IsAuthenticated) {%&gt;Welcome <b>&lt;%= Html.Encode(Page.User.Identity.Name) %&gt;</b>![ &lt;%=Html.ActionLink(&quot;Logout&quot;, &quot;Logout&quot;, &quot;Account&quot;) %&gt; ]&lt;%}else {%&gt; [ &lt;%=Html.ActionLink(&quot;Login&quot;, &quot;Login&quot;, &quot;Account&quot;) %&gt; ]&lt;%}%&gt;</div>{% endcodeblock %}<p>Now let&#8217;s take the same example and convert it to <a href="http://velocity.apache.org/engine/releases/velocity-1.5/user-guide.html" target="_blank">NVelocity</a>, another view engine with a looser syntax:</p>{% codeblock %}<div id="logindisplay">  #if ($isAuthenticated)      Welcome <b>$html.encode($user.name)</b>!        [ $html.actionlink(&quot;Logout&quot;, &quot;logout&quot;, &quot;account&quot;) ]   #else       [ $html.actionlink(&quot;Login&quot;, &quot;login&quot;, &quot;account&quot;) ] #end</div>{% endcodeblock %}<p>We&#8217;d have to stuff the $isAuthenticated and $user values into ViewData, but that&#8217;s a piece of cake.&#160; This is a great example of how concise we can get if we don&#8217;t rely on all that strong typing.&#160; <em>The beauty of this is, the key that you use for ViewData becomes the object you interact with on the view</em>.</p><p>In NVelocity:</p><ul><li>case doesn&#8217;t matter</li><li>no need to open up &lt;% %&gt; tags, you can embed it directly in your template</li><li>type doesn&#8217;t matter.&#160; It&#8217;s evaluated at runtime.</li></ul><p>There are some downsides, however:</p><ul><li>You don&#8217;t get compile time checking for your views.&#160; If I wrote $htlm.actionlink(..)&#160; I&#8217;d get an error at runtime.</li><li>Performance.&#160; Compiled views are much faster than interpreted ones.&#160; It&#8217;s likely that this doesn&#8217;t matter for most sites out there.</li><li>No intellisense.&#160; (The arguments to ActionLink above are not obvious, so you just have to memorize it)</li><li><strong>No Refactoring support</strong>.&#160; This is a big one.&#160; If you rename your actions, you&#8217;ll have to do a string comparison search to get the various links you might having lying around in your view.</li></ul><p>That last one is really the only one that I miss when doing something in NVelocity.&#160; In any case, try it out, see what you think!</p></p>
</div>
  <footer>
    <a rel="full-article" href="/blog/2008/10/the-curly-brace-tax/">Read on &rarr;</a>
  </footer>


  </article>

<nav role="pagination">
  <div>
    
      <a class="prev" href="/blog/page/12/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/10/">Newer &rarr;</a>
    
  </div>
</nav>

<script type="text/javascript">
    var disqus_shortname = 'subdigital';
    (function () {
      var s = document.createElement('script'); s.async = true;
      s.type = 'text/javascript';
      s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
      (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

</div>
<aside role=sidebar>
  
    <section>
  <h1>Who am I?</h1>
  <p>I&#8217;m Ben Scheirman. I make Rails &amp; iPhone apps for <a href="http://chaione.com" target="_blank">ChaiONE</a> in Houston, TX.</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2011/08/vim---could-not-invoke-jslint/">Vim - Could Not Invoke JSLint</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/08/is-rails-exempt-from-software-principles/">Is Rails Exempt?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/08/when-viewwillappear-isnt-called/">When viewWillAppear: Isn&#8217;t Called</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/08/moving-my-blog/">Moving My Blog</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/08/my-vim-journey/">My Vim Journey</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("subdigital", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/subdigital" class="twitter-follow-button" data-width="208px" data-show-count="false">Follow @subdigital</a>
  
</section>


<section>
  <h1>On Delicious</h1>
  <script type="text/javascript" src="http://feeds.delicious.com/v2/js/subdigital?title=&count=3&sort=date&extended"></script>
  <p><a href="http://delicious.com/subdigital">My Delicious Bookmarks &raquo;</a></p>
</section>



  
</aside>

    </div>
  </div>
  <footer>
<a style="display:block; float: right" title="Real Time Analytics" href="http://getclicky.com/66470389"><img alt="Real Time Analytics" src="//static.getclicky.com/media/links/badge.gif" border="0" /></a>
<script src="//static.getclicky.com/js" type="text/javascript"></script>
<script type="text/javascript">try{ clicky.init(66470389); }catch(e){}</script>
<noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/66470389ns.gif" /></p></noscript>

<p>
  Copyright &copy; 2011 - Ben Scheirman -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
</body>
</html>
